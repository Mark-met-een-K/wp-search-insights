jQuery(document).ready(function(e){i();function i(){e(".wpsi-table").each(function(){e(this).DataTable({dom:'frt<"table-footer"p><"clear">B',pageLength:6,conditionalPaging:true,buttons:[{extend:"csv",text:"Download CSV"}],language:{paginate:{previous:"Previous",next:"Next",},searchPlaceholder:"Search",search:"",emptyTable:"No searches recorded in selected period!"},order:[[2,"desc"]],})});e(".dataTables_filter").each(function(){e(this).append(wpsi.dateFilter)});c();var j=e("#wpsi-recent-table_wrapper > div.dt-buttons").addClass("csvDownloadBtn").detach();if(!e(".wpsi-nr-footer").find(".csvDownloadBtn").length){e(".wpsi-nr-footer").append(j)}var k=e(".form-table > tbody:nth-child(1) > tr:nth-child(7)").detach();e("#filter-inner ").append(k)}e(".wpsi-date-container").html(wpsi.dateFilter);e(document).on("change",".wpsi-date-filter",function(n){n.stopPropagation();var k=e(this).closest(".item-content");var j=(k.find(".dataTable").length);var l=k.find(".wpsi-date-filter").val();var m=e(this).closest(".wpsi-item").data("table_type");k.html("loading...");e.ajax({type:"GET",url:wpsi.ajaxurl,dataType:"json",data:({action:"wpsi_get_datatable",range:l,type:m,token:wpsi.token}),success:function(o){k.html(o.html);if(j){i()}else{k.find(".wpsi-date-container").html(wpsi.dateFilter)}k.find(".wpsi-date-filter").val(l)}})});e("ul.tabs li").click(function(){var j=e(this).attr("data-tab");if(j!=="dashboard"){e("#wpsi-toggle-link-wrap").hide()}else{e("#wpsi-toggle-link-wrap").show()}e("ul.tabs li").removeClass("current");e(".tab-content").removeClass("current");e(this).addClass("current");e("#"+j).addClass("current")});var d="#"+window.location.hash.substr(1);var b=window.location.hash.substr(1).replace("#top","");var a=e(".tab-"+b).attr("href");if(a===d){e(".tab-"+b)[0].click();window.location.href=a}var f=JSON.parse(localStorage.getItem("wpsi_grid_configuration"))||{};var g=e("#wpsi-toggle-dashboard :checkbox");if(localStorage.getItem("wpsi_grid_initialized")===null){g.each(function(){f[this.id]="checked"});localStorage.setItem("wpsi_grid_configuration",JSON.stringify(f));localStorage.setItem("wpsi_grid_initialized","set")}g.on("change",function(){h()});function h(){g.each(function(){f[this.id]=this.checked});localStorage.setItem("wpsi_grid_configuration",JSON.stringify(f))}e.each(f,function(j,k){e("#"+j).prop("checked",k)});e("#wpsi-toggle-dashboard").hide();e("#wpsi-show-toggles").click(function(){if(e("#wpsi-toggle-dashboard").is(":visible")){e("#wpsi-toggle-dashboard").slideUp();e("#wpsi-toggle-arrows").attr("class","dashicons dashicons-arrow-down-alt2")}else{e("#wpsi-toggle-dashboard").slideDown();e("#wpsi-toggle-arrows").attr("class","dashicons dashicons-arrow-up-alt2")}});function c(){e(".table-footer").append(e("#wpsi-delete-selected"));e("#wpsi-delete-selected").attr("disabled",true);e(".dataTable tbody").on("click","tr",function(k){e("#wpsi-delete-selected").attr("disabled",true);if(e(this).hasClass("wpsi-selected")){e(this).removeClass("wpsi-selected")}else{e(this).addClass("wpsi-selected")}var j=e(this).closest(".search-insights-table").find(".dataTable");j.find(".wpsi-selected").each(function(){e("#wpsi-delete-selected").attr("disabled",false)})});e(document).on("click","#wpsi-delete-selected",function(){var j=[];e(".dataTable").each(function(){var k=e(this);k.find(".wpsi-selected").each(function(){var l=e(this);j.push(e(this).find(".wpsi-term").data("term_id"));l.css("background-color","#d7263d2e")})});e.ajax({type:"POST",url:wpsi.ajaxurl,dataType:"json",data:({action:"wpsi_delete_terms",term_ids:JSON.stringify(j),token:wpsi.token}),success:function(k){e(".dataTable").each(function(){var l=e(this).DataTable();while(e(".wpsi-selected").length){l.row(".wpsi-selected").remove().draw(false)}});e("#wpsi-delete-selected").attr("disabled",true)}})})}});