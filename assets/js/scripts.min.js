jQuery(document).ready(function(j){var f=768;var d=480;var g=5;var k=7;var l="simple_numbers";var o="simple";var i=j("#wpsi-delete-selected");var n=0;j(window).on("resize",function(){c()});function c(){j(".item-content").each(function(){if(j(this).closest(".wpsi-item").hasClass("wpsi-load-ajax")){var q=j(this).find("table").DataTable();var p=q.column(2);var r=j(window);if(r.width()>f){if(!p.visible()){p.visible(true)}}else{p.visible(false)}q.columns.adjust().draw();if(r.width()<d){q.page.len(g).draw()}else{q.page.len(k).draw()}}})}window.wpsiLoadAjaxTables=function(){j(".item-content").each(function(){if(j(this).closest(".wpsi-item").hasClass("wpsi-load-ajax")){a(j(this),1,0)}})};window.wpsiLoadAjaxTables();function b(q){var u=q.find(".wpsi-table");var v=j(window);var p=k;var s=l;var t=true;if(v.width()<f){t=false}var r='{ "visible": '+t+',  "targets": [ 2 ] }';if(v.width()<d){p=g;s=o}u.DataTable({dom:'frt<"table-footer"p<"wpsi-page-nr">><"clear">B',pageLength:p,pagingType:s,stateSave:true,columns:[{width:"15%"},{width:"5%"},{width:"12%"},{width:""},{width:"15%"},],columnDefs:[{visible:false,targets:[3]},{visible:t,targets:[2]},{iDataSort:3,aTargets:[2]},r,{targets:[1,2,3,4],searchable:false}],buttons:[],conditionalPaging:true,language:{paginate:{previous:wpsi.localize.previous,next:wpsi.localize.next,},searchPlaceholder:wpsi.localize.search,search:"",emptyTable:wpsi.localize["no-searches"]},order:[[2,"desc"]],});j(".wpsi-page-nr").text(1);q.find(".wpsi-table").on("page.dt",function(){var x=j(this).closest("table").DataTable();var y=x.page.info();n=y.page;if(v.width()<d){var w=n+1;j(".wpsi-page-nr").text(w+"/"+y.pages)}})}function e(r){var p=wpsi.localize;for(var q in p){if(p.hasOwnProperty(q)){if(q===r){return p[q]}}}return r}function a(p,t,u){var r=p.closest(".wpsi-item").data("table_type");if(t===1){p.html(wpsi.skeleton)}var s=localStorage.getItem("wpsi_range_start");var q=localStorage.getItem("wpsi_range_end");if(s===null||q===null){s=moment().subtract(1,"week").unix();q=moment().unix();localStorage.setItem("wpsi_range_start",s);localStorage.setItem("wpsi_range_end",q)}s=parseInt(s);q=parseInt(q);j.ajax({type:"GET",url:wpsi.ajaxurl,dataType:"json",data:({action:"wpsi_get_datatable",start:s,end:q,page:t,type:r,token:wpsi.token}),success:function(w){if(t===1){p.html(w.html);if(r==="all"){b(p);h()}}else{var y=p.find("table").DataTable();var v=w.html.length;for(var x in w.html){if(w.html.hasOwnProperty(x)){var z=j(w.html[x]);if(parseInt(x)>=(v-1)){y.row.add(z).draw();y.page(n).draw(false)}else{y.row.add(z)}}}}u+=w.batch;if(w.total_rows>u){t++;a(p,t,u)}else{t=1}}})}function h(){j(".table-footer").append(i);i.show();j("#wpsi-delete-selected").attr("disabled",true);j(".dataTable tbody").on("click","tr",function(q){j("#wpsi-delete-selected").attr("disabled",true);if(j(this).hasClass("wpsi-selected")){j(this).removeClass("wpsi-selected")}else{j(this).addClass("wpsi-selected")}var p=j(this).closest(".item-content").find(".dataTable");p.find(".wpsi-selected").each(function(){j("#wpsi-delete-selected").attr("disabled",false)})});j(document).on("click","#wpsi-delete-selected",function(){var p=[];j(".dataTable").each(function(){var q=j(this);q.find(".wpsi-selected").each(function(){var r=j(this);p.push(j(this).find(".wpsi-term").data("term_id"));r.css("background-color","#d7263d2e")})});j.ajax({type:"POST",url:wpsi.ajaxurl,dataType:"json",data:({action:"wpsi_delete_terms",term_ids:JSON.stringify(p),token:wpsi.token}),success:function(q){j(".dataTable").each(function(){var r=j(this).DataTable();while(j(".wpsi-selected").length){r.row(".wpsi-selected").remove().draw(false)}});j("#wpsi-delete-selected").attr("disabled",true)}})})}j(document).on("click","#wpsi-start-export",m);if(wpsi.export_in_progress){m()}function m(){var p=j(".wpsi-download-link");var q=j("#wpsi-start-export");var s=localStorage.getItem("wpsi_range_start");var r=localStorage.getItem("wpsi_range_end");if(s===null||r===null){s=moment().subtract(1,"week").unix();r=moment().unix();localStorage.setItem("wpsi_range_start",s);localStorage.setItem("wpsi_range_end",r)}s=parseInt(s);r=parseInt(r);q.prop("disabled",true);j.ajax({type:"GET",url:wpsi.ajaxurl,dataType:"json",data:({action:"wpsi_start_export",date_from:s,date_to:r,token:wpsi.token,}),success:function(t){if(t.percent<100){p.html(t.percent+"%");m()}else{var u='<div><a href="'+t.path+'">'+wpsi.strings.download+"</a></div>";p.html(u);q.prop("disabled",false)}}})}j(".wpsi-tips-tricks-element a").hover(function(){j(this).find(".wpsi-bullet").css("background-color","#d7263d")},function(){j(this).find(".wpsi-bullet").css("background-color","")})});