jQuery(document).ready(function(f){var d=f("#wpsi-delete-selected");j();function j(){f(".wpsi-table").each(function(){f(this).DataTable({dom:'frt<"table-footer"p><"clear">B',pageLength:6,conditionalPaging:true,buttons:[{extend:"csv",text:"Download CSV"}],language:{paginate:{previous:"Previous",next:"Next",},searchPlaceholder:"Search",search:"",emptyTable:"No searches recorded in selected period!"},order:[[2,"desc"]],})});f(".dataTables_filter").each(function(){f(this).append(wpsi.dateFilter)});c();var k=f("#wpsi-recent-table_wrapper > div.dt-buttons").addClass("csvDownloadBtn").detach();if(!f(".wpsi-nr-footer").find(".csvDownloadBtn").length){f(".wpsi-nr-footer").append(k)}var l=f(".form-table > tbody:nth-child(1) > tr:nth-child(7)").detach();f("#filter-inner ").append(l)}f(".wpsi-date-container").html(wpsi.dateFilter);f(document).on("change",".wpsi-date-filter",function(o){o.stopPropagation();var l=f(this).closest(".item-content");var k=(l.find(".dataTable").length);var m=l.find(".wpsi-date-filter").val();var n=f(this).closest(".wpsi-item").data("table_type");l.html("loading...");f.ajax({type:"GET",url:wpsi.ajaxurl,dataType:"json",data:({action:"wpsi_get_datatable",range:m,type:n,token:wpsi.token}),success:function(p){l.html(p.html);if(k){j()}else{l.find(".wpsi-date-container").html(wpsi.dateFilter)}l.find(".wpsi-date-filter").val(m)}})});f("ul.tabs li").click(function(){var k=f(this).attr("data-tab");if(k!=="dashboard"){f("#wpsi-toggle-link-wrap").hide()}else{f("#wpsi-toggle-link-wrap").show()}f("ul.tabs li").removeClass("current");f(".tab-content").removeClass("current");f(this).addClass("current");f("#"+k).addClass("current")});var e="#"+window.location.hash.substr(1);var b=window.location.hash.substr(1).replace("#top","");var a=f(".tab-"+b).attr("href");if(a===e){f(".tab-"+b)[0].click();window.location.href=a}var g=JSON.parse(localStorage.getItem("wpsi_grid_configuration"))||{};var h=f("#wpsi-toggle-dashboard :checkbox");if(localStorage.getItem("wpsi_grid_initialized")===null){h.each(function(){g[this.id]="checked"});localStorage.setItem("wpsi_grid_configuration",JSON.stringify(g));localStorage.setItem("wpsi_grid_initialized","set")}h.on("change",function(){i()});function i(){h.each(function(){g[this.id]=this.checked});localStorage.setItem("wpsi_grid_configuration",JSON.stringify(g))}f.each(g,function(k,l){f("#"+k).prop("checked",l)});f("#wpsi-toggle-dashboard").hide();f("#wpsi-show-toggles").click(function(){if(f("#wpsi-toggle-dashboard").is(":visible")){f("#wpsi-toggle-dashboard").slideUp();f("#wpsi-toggle-arrows").attr("class","dashicons dashicons-arrow-down-alt2")}else{f("#wpsi-toggle-dashboard").slideDown();f("#wpsi-toggle-arrows").attr("class","dashicons dashicons-arrow-up-alt2")}});function c(){f(".table-footer").append(d);f("#wpsi-delete-selected").attr("disabled",true);f(".dataTable tbody").on("click","tr",function(l){f("#wpsi-delete-selected").attr("disabled",true);if(f(this).hasClass("wpsi-selected")){f(this).removeClass("wpsi-selected")}else{f(this).addClass("wpsi-selected")}var k=f(this).closest(".search-insights-table").find(".dataTable");k.find(".wpsi-selected").each(function(){f("#wpsi-delete-selected").attr("disabled",false)})});f(document).on("click","#wpsi-delete-selected",function(){var k=[];f(".dataTable").each(function(){var l=f(this);l.find(".wpsi-selected").each(function(){var m=f(this);k.push(f(this).find(".wpsi-term").data("term_id"));m.css("background-color","#d7263d2e")})});f.ajax({type:"POST",url:wpsi.ajaxurl,dataType:"json",data:({action:"wpsi_delete_terms",term_ids:JSON.stringify(k),token:wpsi.token}),success:function(l){f(".dataTable").each(function(){var m=f(this).DataTable();while(f(".wpsi-selected").length){m.row(".wpsi-selected").remove().draw(false)}});f("#wpsi-delete-selected").attr("disabled",true)}})})}});