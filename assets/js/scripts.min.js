jQuery(document).ready(function(e){a();function a(){e(".wpsi-table").each(function(){e(this).DataTable({dom:'frt<"table-footer"p><"clear">B',pageLength:6,conditionalPaging:true,buttons:[{extend:"csv",text:"Download CSV"}],language:{paginate:{previous:"Previous",next:"Next",},searchPlaceholder:"Search",search:"",emptyTable:"No searches recorded yet!"},order:[[1,"desc"]],})});e(".dataTables_filter").each(function(){e(this).append(wpsi.dateFilter)});c();var i=e("#wpsi-recent-table_wrapper > div.dt-buttons").addClass("csvDownloadBtn").detach();if(!e(".wpsi-nr-footer").find(".csvDownloadBtn").length){e(".wpsi-nr-footer").append(i)}var j=e(".form-table > tbody:nth-child(1) > tr:nth-child(7)").detach();e("#filter-inner ").append(j)}e(".wpsi-date-container").html(wpsi.dateFilter);e(document).on("change",".wpsi-date-filter",function(m){m.stopPropagation();var j=e(this).closest(".item-content");var i=(j.find(".dataTable").length);var k=j.find(".wpsi-date-filter").val();var l=e(this).closest(".wpsi-item").data("table_type");e.ajax({type:"GET",url:wpsi.ajaxurl,dataType:"json",data:({action:"wpsi_get_datatable",range:k,type:l,token:wpsi.token}),success:function(n){j.html(n.html);if(i){a()}else{j.find(".wpsi-date-container").html(wpsi.dateFilter)}j.find(".wpsi-date-filter").val(k)}})});var g="#"+window.location.hash.substr(1);e("ul.tabs li").click(function(){var i=e(this).attr("data-tab");e("ul.tabs li").removeClass("current");e(".tab-content").removeClass("current");e(this).addClass("current");e("#"+i).addClass("current")});var b=e(".tab-settings").attr("href");if(b===g){e(".tab-settings")[0].click();window.location.href=b}var f=JSON.parse(localStorage.getItem("formValues"))||{};var d=e("#wpsi-toggle-dashboard :checkbox");if(localStorage.getItem("wpsiDashboardDefaultsSet")===null){console.log("localstorage default not set, enable all");d.each(function(){f[this.id]="checked"});localStorage.setItem("formValues",JSON.stringify(f));localStorage.setItem("wpsiDashboardDefaultsSet","set")}d.on("change",function(){h()});function h(){d.each(function(){f[this.id]=this.checked});localStorage.setItem("formValues",JSON.stringify(f))}e.each(f,function(i,j){e("#"+i).prop("checked",j)});e("#wpsi-toggle-dashboard").hide();e("#wpsi-show-toggles").click(function(){if(e("#wpsi-toggle-dashboard").is(":visible")){e("#wpsi-toggle-dashboard").hide();e("#wpsi-toggle-arrows").attr("class","dashicons dashicons-arrow-down-alt2")}else{e("#wpsi-toggle-dashboard").show();e("#wpsi-toggle-arrows").attr("class","dashicons dashicons-arrow-up-alt2")}});function c(){e(".table-footer").append(e("#wpsi-delete-selected"));e("#wpsi-delete-selected").attr("disabled",true);e(".dataTable tbody").on("click","tr",function(j){e("#wpsi-delete-selected").attr("disabled",true);if(e(this).hasClass("wpsi-selected")){e(this).removeClass("wpsi-selected")}else{e(this).addClass("wpsi-selected")}var i=e(this).closest(".search-insights-table").find(".dataTable");i.find(".wpsi-selected").each(function(){e("#wpsi-delete-selected").attr("disabled",false)})});e(document).on("click","#wpsi-delete-selected",function(){var i=[];e(".dataTable").each(function(){var j=e(this);j.find(".wpsi-selected").each(function(){var k=e(this);i.push(e(this).find(".wpsi-term").data("term_id"));k.css("background-color","#d7263d2e")})});e.ajax({type:"POST",url:wpsi.ajaxurl,dataType:"json",data:({action:"wpsi_delete_terms",term_ids:JSON.stringify(i),token:wpsi.token}),success:function(j){e(".dataTable").each(function(){var k=e(this).DataTable();while(e(".wpsi-selected").length){k.row(".wpsi-selected").remove().draw(false)}});e("#wpsi-delete-selected").attr("disabled",true)}})})}});