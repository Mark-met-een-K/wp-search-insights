(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b=b||self,b.Muuri=a())}(this,function(){var bj="Muuri";var al={};var W="swap";var ah="move";var bE="synchronize";var U="layoutStart";var y="layoutEnd";var ai="add";var bq="remove";var bi="showStart";var m="showEnd";var u="hideStart";var bw="hideEnd";var S="filter";var aV="sort";var j="move";var t="send";var bN="beforeSend";var bD="receive";var aJ="beforeReceive";var bL="dragInit";var i="dragStart";var X="dragMove";var aq="dragScroll";var at="dragEnd";var q="dragReleaseStart";var ae="dragReleaseEnd";var bn="destroy";function aw(){this._events={};this._queue=[];this._counter=0;this._isDestroyed=false}aw.prototype.on=function(bR,bS){if(this._isDestroyed){return this}var e=this._events[bR];if(!e){e=this._events[bR]=[]}e.push(bS);return this};aw.prototype.off=function(bS,bT){if(this._isDestroyed){return this}var bR=this._events[bS];if(!bR||!bR.length){return this}if(!bT){bR.length=0;return this}var e=bR.length;while(e--){if(bT===bR[e]){bR.splice(e,1)}}return this};aw.prototype.emit=function(bR,bV,bU,bT){if(this._isDestroyed){return this}var bY=this._events[bR];if(!bY||!bY.length){return this}var bW=this._queue;var bX=bW.length;var e=arguments.length-1;var bS;for(bS=0;bS<bY.length;bS++){bW.push(bY[bS])}++this._counter;for(bS=bX,bX=bW.length;bS<bX;bS++){e===0?bW[bS]():e===1?bW[bS](bV):e===2?bW[bS](bV,bU):bW[bS](bV,bU,bT);if(this._isDestroyed){return this}}--this._counter;if(!this._counter){bW.length=0}return this};aw.prototype.destroy=function(){if(this._isDestroyed){return this}var e=this._events;var bR;this._isDestroyed=true;this._queue.length=this._counter=0;for(bR in e){if(e[bR]){e[bR].length=0;e[bR]=undefined}}return this};var P="transform";var M="transform";var f=window.document.documentElement.style;var r="transform";var ag="Transform";var aG=false;["","Webkit","Moz","O","ms"].forEach(function(bR){if(aG){return}var e=bR?bR+ag:r;if(f[e]!==undefined){bR=bR.toLowerCase();P=bR?"-"+bR+"-"+r:r;M=e;aG=true}});var a1=typeof WeakMap==="function"?new WeakMap():null;function bf(e,bR){var bS=a1&&a1.get(e);if(!bS){bS=window.getComputedStyle(e,null);if(a1){a1.set(e,bS)}}return bS.getPropertyValue(bR==="transform"?P:bR)}var a6=/([A-Z])/g;function J(e){return e.replace(a6,"-$1").toLowerCase()}var by="function";function w(e){return typeof e===by}var av="transform";function aW(e,bR){for(var bS in bR){e.style[bS===av?M:bS]=bR[bS]}}function aX(e){this._element=e;this._animation=null;this._callback=null;this._props=[];this._values=[];this._keyframes=[];this._options={};this._isDestroyed=false;this._onFinish=this._onFinish.bind(this)}aX.prototype.start=function(bY,bZ,b3){if(this._isDestroyed){return}var bT=this._animation;var b0=this._props;var bW=this._values;var e=b3||0;var bR=false;if(bT){var b2=0;var b1;for(var bX in bZ){++b2;b1=b0.indexOf(bX);if(b1===-1||bZ[bX]!==bW[b1]){bR=true;break}}if(!bR&&b2!==b0.length){bR=true}}if(bR){bT.cancel()}this._callback=w(e.onFinish)?e.onFinish:null;if(bT&&!bR){return}b0.length=bW.length=0;for(bX in bZ){b0.push(bX);bW.push(bZ[bX])}var bS=this._keyframes;bS[0]=bY;bS[1]=bZ;var bU=this._options;bU.duration=e.duration||300;bU.easing=e.easing||"ease";var bV=this._element;bT=bV.animate(bS,bU);bT.onfinish=this._onFinish;this._animation=bT;aW(bV,bZ)};aX.prototype.stop=function(bU){if(this._isDestroyed||!this._animation){return}var bT=this._element;var bR=this._props;var e=this._values;var bV;var bW;var bS;if(!bU){for(bS=0;bS<bR.length;bS++){bV=bR[bS];bW=bf(bT,J(bV));bT.style[bV==="transform"?M:bV]=bW}}else{aW(bT,bU)}this._animation.cancel();this._animation=this._callback=null;bR.length=e.length=0};aX.prototype.isAnimating=function(){return !!this._animation};aX.prototype.destroy=function(){if(this._isDestroyed){return}this.stop();this._element=this._options=this._keyframes=null;this._isDestroyed=true};aX.prototype._onFinish=function(){var e=this._callback;this._animation=this._callback=null;this._props.length=this._values.length=0;e&&e()};var bQ=["","webkit","moz","ms","o","Webkit","Moz","MS","O"];function bC(e,bV){var bT=bV[0].toUpperCase()+bV.slice(1);var bS=0;var bU;var bR;while(bS<bQ.length){bU=bQ[bS];bR=bU?bU+bT:bV;if(bR in e){return bR}++bS}return null}var aK=1000/60;var bA=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return this.setTimeout(function(){e(aK)},aK)}).bind(window);var N=false;try{var ad=Object.defineProperty({},"passive",{get:function(){N=true}});window.addEventListener("testPassive",null,ad);window.removeEventListener("testPassive",null,ad)}catch(a9){}var bJ={start:"start",move:"move",end:"end",cancel:"cancel"};var aY=!!("ontouchstart" in window||window.TouchEvent);var ac=!!window.PointerEvent;var G=!!window.navigator.msPointerEnabled;var bF=/(android)/i.test(window.navigator.userAgent);var bB=N?{passive:true}:false;var aH="touchAction";var ay=bC(window.document.documentElement.style,aH);var aM="auto";function bG(e,bR){this._element=e;this._emitter=new aw();this._isDestroyed=false;this._cssProps={};this._touchAction="";this._startEvent=null;this._pointerId=null;this._startTime=0;this._startX=0;this._startY=0;this._currentX=0;this._currentY=0;this._preStartCheck=this._preStartCheck.bind(this);this._abortNonCancelable=this._abortNonCancelable.bind(this);this._onStart=this._onStart.bind(this);this._onMove=this._onMove.bind(this);this._onCancel=this._onCancel.bind(this);this._onEnd=this._onEnd.bind(this);this.setCssProps(bR);if(!this._touchAction){this.setTouchAction(aM)}e.addEventListener("dragstart",bG._preventDefault,false);e.addEventListener(bG._events.start,this._preStartCheck,bB);if(aY&&!ac&&!G){e.addEventListener(bG._mouseEvents.start,this._preStartCheck,bB)}}bG._pointerEvents={start:"pointerdown",move:"pointermove",cancel:"pointercancel",end:"pointerup"};bG._msPointerEvents={start:"MSPointerDown",move:"MSPointerMove",cancel:"MSPointerCancel",end:"MSPointerUp"};bG._touchEvents={start:"touchstart",move:"touchmove",cancel:"touchcancel",end:"touchend"};bG._mouseEvents={start:"mousedown",move:"mousemove",cancel:"",end:"mouseup"};bG._events=(function(){if(ac){return bG._pointerEvents}if(G){return bG._msPointerEvents}if(aY){return bG._touchEvents}return bG._mouseEvents})();bG._emitter=new aw();bG._activeInstances=[];bG._preventDefault=function(bR){if(bR.preventDefault&&bR.cancelable!==false){bR.preventDefault()}};bG._activateInstance=function(e){var bR=bG._activeInstances.indexOf(e);if(bR>-1){return}bG._activeInstances.push(e);bG._emitter.on(bJ.move,e._onMove);bG._emitter.on(bJ.cancel,e._onCancel);bG._emitter.on(bJ.end,e._onEnd);if(bG._activeInstances.length===1){bG._bindListeners()}};bG._deactivateInstance=function(e){var bR=bG._activeInstances.indexOf(e);if(bR===-1){return}bG._activeInstances.splice(bR,1);bG._emitter.off(bJ.move,e._onMove);bG._emitter.off(bJ.cancel,e._onCancel);bG._emitter.off(bJ.end,e._onEnd);if(!bG._activeInstances.length){bG._unbindListeners()}};bG._bindListeners=function(){var e=bG._events;window.addEventListener(e.move,bG._onMove,bB);window.addEventListener(e.end,bG._onEnd,bB);e.cancel&&window.addEventListener(e.cancel,bG._onCancel,bB)};bG._unbindListeners=function(){var e=bG._events;window.removeEventListener(e.move,bG._onMove,bB);window.removeEventListener(e.end,bG._onEnd,bB);e.cancel&&window.removeEventListener(e.cancel,bG._onCancel,bB)};bG._getEventPointerId=function(e){if(typeof e.pointerId==="number"){return e.pointerId}if(e.changedTouches){return e.changedTouches[0]?e.changedTouches[0].identifier:null}return 1};bG._getTouchById=function(bR,bS){if(typeof bR.pointerId==="number"){return bR.pointerId===bS?bR:null}if(bR.changedTouches){for(var e=0;e<bR.changedTouches.length;e++){if(bR.changedTouches[e].identifier===bS){return bR.changedTouches[e]}}return null}return bR};bG._onMove=function(bR){bG._emitter.emit(bJ.move,bR)};bG._onCancel=function(bR){bG._emitter.emit(bJ.cancel,bR)};bG._onEnd=function(bR){bG._emitter.emit(bJ.end,bR)};bG.prototype._reset=function(){if(this._isDestroyed){return}this._pointerId=null;this._startTime=0;this._startX=0;this._startY=0;this._currentX=0;this._currentY=0;this._startEvent=null;this._element.removeEventListener(bG._touchEvents.start,this._abortNonCancelable,bB);bG._deactivateInstance(this)};bG.prototype._createEvent=function(bR,bS){var bT=this._getTrackedTouch(bS);return{type:bR,srcEvent:bS,distance:this.getDistance(),deltaX:this.getDeltaX(),deltaY:this.getDeltaY(),deltaTime:bR===bJ.start?0:this.getDeltaTime(),isFirst:bR===bJ.start,isFinal:bR===bJ.end||bR===bJ.cancel,identifier:this._pointerId,screenX:bT.screenX,screenY:bT.screenY,clientX:bT.clientX,clientY:bT.clientY,pageX:bT.pageX,pageY:bT.pageY,target:bT.target}};bG.prototype._emit=function(bR,bS){this._emitter.emit(bR,this._createEvent(bR,bS))};bG.prototype._getTrackedTouch=function(bR){if(this._pointerId===null){return null}else{return bG._getTouchById(bR,this._pointerId)}};bG.prototype._preStartCheck=function(bR){if(this._isDestroyed){return}if(this.isDragging()){return}if(bF&&bR.cancelable===false){return}if(bR.button){return}this._pointerId=bG._getEventPointerId(bR);if(this._pointerId===null){return}this._startEvent=bR;if(aY&&(ac||G)){if(bF){this._element.addEventListener(bG._touchEvents.start,this._abortNonCancelable,bB)}bA(this._onStart)}else{this._onStart()}};bG.prototype._abortNonCancelable=function(bR){this._element.removeEventListener(bG._touchEvents.start,this._abortNonCancelable,bB);if(this._startEvent&&bR.cancelable===false){this._pointerId=null;this._startEvent=null}};bG.prototype._onStart=function(){var bR=this._startEvent;if(!bR){return}this._startEvent=null;var bS=this._getTrackedTouch(bR);if(!bS){return}this._startX=this._currentX=bS.clientX;this._startY=this._currentY=bS.clientY;this._startTime=Date.now();this._emit(bJ.start,bR);bG._activateInstance(this)};bG.prototype._onMove=function(bR){var bS=this._getTrackedTouch(bR);if(!bS){return}this._currentX=bS.clientX;this._currentY=bS.clientY;this._emit(bJ.move,bR)};bG.prototype._onCancel=function(bR){if(!this._getTrackedTouch(bR)){return}this._emit(bJ.cancel,bR);this._reset()};bG.prototype._onEnd=function(bR){if(!this._getTrackedTouch(bR)){return}this._emit(bJ.end,bR);this._reset()};bG.prototype.isDragging=function(){return this._pointerId!==null};bG.prototype.setTouchAction=function(e){this._touchAction=e;if(ay){this._cssProps[ay]="";this._element.style[ay]=e}if(aY){this._element.removeEventListener(bG._touchEvents.start,bG._preventDefault,false);if(this._element.style[ay]!==e){this._element.addEventListener(bG._touchEvents.start,bG._preventDefault,false)}}};bG.prototype.setCssProps=function(bT){if(!bT){return}var bR=this._cssProps;var bS=this._element;var bU;var e;for(bU in bR){bS.style[bU]=bR[bU];delete bR[bU]}for(bU in bT){if(!bT[bU]){continue}if(bU===aH){this.setTouchAction(bT[bU]);continue}e=bC(bS.style,bU);if(!e){continue}bR[e]="";bS.style[e]=bT[bU]}};bG.prototype.getDeltaX=function(){return this._currentX-this._startX};bG.prototype.getDeltaY=function(){return this._currentY-this._startY};bG.prototype.getDistance=function(){var e=this.getDeltaX();var bR=this.getDeltaY();return Math.sqrt(e*e+bR*bR)};bG.prototype.getDeltaTime=function(){return this._startTime?Date.now()-this._startTime:0};bG.prototype.on=function(e,bR){this._emitter.on(e,bR)};bG.prototype.off=function(e,bR){this._emitter.off(eventName,bR)};bG.prototype.destroy=function(){if(this._isDestroyed){return}var bR=this._element;var e=bG._events;this._reset();this._emitter.destroy();bR.removeEventListener(e.start,this._preStartCheck,bB);bR.removeEventListener(bG._mouseEvents.start,this._preStartCheck,bB);bR.removeEventListener("dragstart",bG._preventDefault,false);bR.removeEventListener(bG._touchEvents.start,bG._preventDefault,false);for(var bS in this._cssProps){bR.style[bS]=this._cssProps[bS];delete this._cssProps[bS]}this._element=null;this._isDestroyed=true};function aD(){this._nextStep=null;this._queue=[];this._reads={};this._writes={};this._batch=[];this._batchReads={};this._batchWrites={};this._step=this._step.bind(this)}aD.prototype.add=function(bU,bS,bT,e){var bR=this._queue.indexOf(bU);if(bR>-1){this._queue[bR]=undefined}e?this._queue.unshift(bU):this._queue.push(bU);this._reads[bU]=bS;this._writes[bU]=bT;if(!this._nextStep){this._nextStep=bA(this._step)}};aD.prototype.cancel=function(bR){var e=this._queue.indexOf(bR);if(e>-1){this._queue[e]=undefined;delete this._reads[bR];delete this._writes[bR]}};aD.prototype._step=function(){var bW=this._queue;var e=this._reads;var bT=this._writes;var bV=this._batch;var bY=this._batchReads;var bX=this._batchWrites;var bS=bW.length;var bR;var bU;this._nextStep=null;for(bU=0;bU<bS;bU++){bR=bW[bU];if(!bR){continue}bV.push(bR);bY[bR]=e[bR];delete e[bR];bX[bR]=bT[bR];delete bT[bR]}bW.length=0;for(bU=0;bU<bS;bU++){bR=bV[bU];if(bY[bR]){bY[bR]();delete bY[bR]}}for(bU=0;bU<bS;bU++){bR=bV[bU];if(bX[bR]){bX[bR]();delete bX[bR]}}bV.length=0;if(!this._nextStep&&bW.length){this._nextStep=bA(this._step)}};var bl=new aD();var k="layout";var a5="visibility";var a2="move";var Q="scroll";var bu="placeholder";function bx(bS,e,bR){return bl.add(bS+k,e,bR)}function br(e){return bl.cancel(e+k)}function bh(bS,e,bR){return bl.add(bS+a5,e,bR)}function bs(e){return bl.cancel(e+a5)}function g(bS,e,bR){return bl.add(bS+a2,e,bR,true)}function aN(e){return bl.cancel(e+a2)}function a(bS,e,bR){return bl.add(bS+Q,e,bR,true)}function bP(e){return bl.cancel(e+Q)}function a3(bS,e,bR){return bl.add(bS+bu,e,bR)}function C(e){return bl.cancel(e+bu)}var V=window.Element.prototype;var aP=V.matches||V.matchesSelector||V.webkitMatchesSelector||V.mozMatchesSelector||V.msMatchesSelector||V.oMatchesSelector||function(){return false};function D(bR,e){return aP.call(bR,e)}function F(e,bR){if(e.classList){e.classList.add(bR)}else{if(!D(e,"."+bR)){e.className+=" "+bR}}}var bk=[];var bm="number";function A(bT,e,bR){var bS=typeof bR===bm?bR:-1;if(bS<0){bS=bT.length-bS+1}bT.splice.apply(bT,bk.concat(bS,0,e));bk.length=0}function aE(bU,e,bS){var bT=bU.length;var bR=Math.max(0,bS?bT:bT-1);return e>bR?bR:e<0?Math.max(bR+e+1,0):e}function aF(bU,e,bR){if(bU.length<2){return}var bT=aE(bU,e);var bS=aE(bU,bR);if(bT!==bS){bU.splice(bS,0,bU.splice(bT,1)[0])}}function ao(bV,bR,bT){if(bV.length<2){return}var bU=aE(bV,bR);var bS=aE(bV,bT);var e;if(bU!==bS){e=bV[bU];bV[bU]=bV[bS];bV[bS]=e}}var a0="cancel";var d="finish";var aO="debounce";var bv=0;function bp(e,bT){var bS;var bR=++bv+aO;if(bT>0){return function(bU){if(bS!==undefined){bS=window.clearTimeout(bS);bl.cancel(bR);if(bU===d){e()}}if(bU!==a0&&bU!==d){bS=window.setTimeout(function(){bS=undefined;bl.add(bR,e,null,true)},bT)}}}return function(bU){if(bU!==a0){e()}}}function R(bR){var e=bf(bR,"transform");if(!e||e==="none"){return false}var bS=bf(bR,"display");if(bS==="inline"||bS==="none"){return false}return true}function aT(bT,bS){var e=window.document;var bR=(bS?bT:bT.parentElement)||e;while(bR&&bR!==e&&bf(bR,"position")==="static"&&!R(bR)){bR=bR.parentElement||e}return bR}function b(bR,e){return parseFloat(bf(bR,e))||0}var bK={};var bI={};var am={};function bO(bR,bT){var e=bT||{};var bS;e.left=0;e.top=0;if(bR===document){return e}e.left=window.pageXOffset||0;e.top=window.pageYOffset||0;if(bR.self===window.self){return e}bS=bR.getBoundingClientRect();e.left+=bS.left;e.top+=bS.top;e.left+=b(bR,"border-left-width");e.top+=b(bR,"border-top-width");return e}function aR(bS,bR,e){am.left=0;am.top=0;if(bS===bR){return am}if(e){bS=aT(bS,true);bR=aT(bR,true);if(bS===bR){return am}}bO(bS,bK);bO(bR,bI);am.left=bI.left-bK.left;am.top=bI.top-bK.top;return am}var bo="overflow";var bd="overflow-x";var bb="overflow-y";var ax="auto";var K="scroll";function aa(e){var bR=bf(e,bo);if(bR===ax||bR===K){return true}bR=bf(e,bd);if(bR===ax||bR===K){return true}bR=bf(e,bb);if(bR===ax||bR===K){return true}return false}function Z(bS,bR,bU){var e=bU||[];var bT=bR?bS:bS.parentNode;while(bT&&bT!==document){if(bT.getRootNode&&bT instanceof DocumentFragment){bT=bT.getRootNode().host;continue}if(aa(bT)){e.push(bT)}bT=bT.parentNode}e.push(window);return e}var bz={};var au="transform";var an="none";var L=/^matrix3d/;var aA=/([^,]*,){4}/;var bt=/([^,]*,){12}/;var p=/[^,]*,/;function bM(bT){bz.x=0;bz.y=0;var bS=bf(bT,au);if(!bS||bS===an){return bz}var bR=L.test(bS);var e=bS.replace(bR?bt:aA,"");var bU=e.replace(p,"");bz.x=parseFloat(e)||0;bz.y=parseFloat(bU)||0;return bz}function ap(e,bR){return"translateX("+e+"px) translateY("+bR+"px)"}function aU(e,bR){if(e.classList){e.classList.remove(bR)}else{if(D(e,"."+bR)){e.className=(" "+e.className+" ").replace(" "+bR+" "," ").trim()}}}var bH=0;var ab=1;var l=2;var aS=3;function H(bU){var bS=bU._element;var bR=bU.getGrid();var bT=bR._settings;this._item=bU;this._gridId=bR._id;this._isDestroyed=false;this._isMigrating=false;this._startPredicate=w(bT.dragStartPredicate)?bT.dragStartPredicate:H.defaultStartPredicate;this._startPredicateState=bH;this._startPredicateResult=undefined;this._hBlockedIndex=null;this._hX1=0;this._hX2=0;this._hY1=0;this._hY2=0;this._reset();this._preStartCheck=this._preStartCheck.bind(this);this._preEndCheck=this._preEndCheck.bind(this);this._onScroll=this._onScroll.bind(this);this._prepareMove=this._prepareMove.bind(this);this._applyMove=this._applyMove.bind(this);this._prepareScroll=this._prepareScroll.bind(this);this._applyScroll=this._applyScroll.bind(this);this._checkOverlap=this._checkOverlap.bind(this);var e=bT.dragSortHeuristics.sortInterval;this._checkOverlapDebounce=bp(this._checkOverlap,e);this._dragger=new bG(bS,bT.dragCssProps);this._dragger.on("start",this._preStartCheck);this._dragger.on("move",this._preStartCheck);this._dragger.on("cancel",this._preEndCheck);this._dragger.on("end",this._preEndCheck)}H.defaultStartPredicate=function(bU,bT,bR){var bS=bU._drag;var e=bS._startPredicateData||bS._setupStartPredicate(bR);if(bT.isFinal){bS._finishStartPredicate(bT);return}if(!e.handleElement){e.handleElement=bS._getStartPredicateHandle(bT);if(!e.handleElement){return false}}if(e.delay){e.event=bT;if(!e.delayTimer){e.delayTimer=window.setTimeout(function(){e.delay=0;if(bS._resolveStartPredicate(e.event)){bS._forceResolveStartPredicate(e.event);bS._resetStartPredicate()}},e.delay)}}return bS._resolveStartPredicate(bT)};H.defaultSortPredicate=(function(){var bU={};var bT={};var bR={};var bS=[];function e(b3,b4,b0){var b1=null;var bZ=b4._settings.dragSort;var bW=-1;var b2;var bX;var bV;var bY;if(bZ===true){bS[0]=b4;bX=bS}else{bX=bZ.call(b4,b3)}if(!Array.isArray(bX)){return b1}for(bY=0;bY<bX.length;bY++){bV=bX[bY];if(bV._isDestroyed){continue}bV._updateBoundingRect();bT.width=bV._width;bT.height=bV._height;bT.left=bV._left;bT.top=bV._top;b2=o(bU,bT);if(b2>b0&&b2>bW){bW=b2;b1=bV}}bS.length=0;return b1}return function(b7,b8){var b1=b7._drag;var b9=b1._getGrid();var b3=b8&&typeof b8.threshold==="number"?b8.threshold:50;var bW=b8&&b8.action===W?W:ah;bU.width=b7._width;bU.height=b7._height;bU.left=b1._elementClientX;bU.top=b1._elementClientY;var bV=e(b7,b9,b3);if(!bV){return false}var b4=0;var bY=0;var b0=-1;var b6;var b5;var b2;var bX;var bZ;if(bV===b9){bU.left=b1._gridX+b7._marginLeft;bU.top=b1._gridY+b7._marginTop}else{bV._updateBorders(1,0,1,0);b4=bV._left+bV._borderLeft;bY=bV._top+bV._borderTop}for(bZ=0;bZ<bV._items.length;bZ++){b2=bV._items[bZ];if(!b2._isActive||b2===b7){continue}b5=true;bT.width=b2._width;bT.height=b2._height;bT.left=b2._left+b2._marginLeft+b4;bT.top=b2._top+b2._marginTop+bY;bX=o(bU,bT);if(bX>b0){b6=bZ;b0=bX}}if(b0<b3&&b7.getGrid()!==bV){b6=b5?-1:0;b0=Infinity}if(b0>=b3){bR.grid=bV;bR.index=b6;bR.action=bW;return bR}return false}})();H.prototype.stop=function(){var bS=this._item;var bR=bS._element;var e=this._getGrid();if(!this._isActive){return this}if(this._isMigrating){this._finishMigration();return this}aN(bS._id);bP(bS._id);this._unbindScrollListeners();this._checkOverlapDebounce("cancel");if(bR.parentNode!==e._element){e._element.appendChild(bR);bR.style[M]=ap(this._gridX,this._gridY)}aU(bR,e._settings.itemDraggingClass);this._reset();return this};H.prototype.destroy=function(){if(this._isDestroyed){return this}this.stop();this._dragger.destroy();this._isDestroyed=true;return this};H.prototype._getGrid=function(){return al[this._gridId]||null};H.prototype._reset=function(){this._isActive=false;this._container=null;this._containingBlock=null;this._dragEvent=null;this._scrollEvent=null;this._scrollers=[];this._left=0;this._top=0;this._gridX=0;this._gridY=0;this._elementClientX=0;this._elementClientY=0;this._containerDiffX=0;this._containerDiffY=0};H.prototype._bindScrollListeners=function(){var bR=this._getGrid()._element;var e=this._container;var bU=this._scrollers;var bT;var bS;bU.length=0;Z(this._item._element,false,bU);if(e!==bR){bT=[];Z(bR,true,bT);for(bS=0;bS<bT.length;bS++){if(bU.indexOf(bT[bS])<0){bU.push(bT[bS])}}}for(bS=0;bS<bU.length;bS++){bU[bS].addEventListener("scroll",this._onScroll)}};H.prototype._unbindScrollListeners=function(){var bR=this._scrollers;var e;for(e=0;e<bR.length;e++){bR[e].removeEventListener("scroll",this._onScroll)}bR.length=0};H.prototype._setupStartPredicate=function(bR){var e=bR||this._getGrid()._settings.dragStartPredicate||0;return(this._startPredicateData={distance:Math.abs(e.distance)||0,delay:Math.max(e.delay,0)||0,handle:typeof e.handle==="string"?e.handle:false})};H.prototype._getStartPredicateHandle=function(bT){var e=this._startPredicateData;var bR=this._item._element;var bS=bR;if(!e.handle){return bS}bS=bT.target;while(bS&&!D(bS,e.handle)){bS=bS!==bR?bS.parentElement:null}return bS||null};H.prototype._resolveStartPredicate=function(bW){var e=this._startPredicateData;if(bW.distance<e.distance||e.delay){return}var bS=e.handleElement.getBoundingClientRect();var bV=bS.left+(window.pageXOffset||0);var bU=bS.top+(window.pageYOffset||0);var bR=bS.width;var bT=bS.height;this._resetStartPredicate();return(bR&&bT&&bW.pageX>=bV&&bW.pageX<bV+bR&&bW.pageY>=bU&&bW.pageY<bU+bT)};H.prototype._forceResolveStartPredicate=function(e){if(!this._isDestroyed&&this._startPredicateState===ab){this._startPredicateState=l;this._onStart(e)}};H.prototype._finishStartPredicate=function(bR){var e=this._item._element;var bS=Math.abs(bR.deltaX)<2&&Math.abs(bR.deltaY)<2&&bR.deltaTime<200;this._resetStartPredicate();if(bS){be(e)}};H.prototype._resetHeuristics=function(e){this._hBlockedIndex=null;this._hX1=this._hX2=e.clientX;this._hY1=this._hY2=e.clientY};H.prototype._checkHeuristics=function(bS){var bU=this._getGrid()._settings.dragSortHeuristics;var b0=bU.minDragDistance;if(b0<=0){this._hBlockedIndex=null;return true}var bZ=bS.clientX;var bV=bS.clientY;var bY=bZ-this._hX2;var bW=bV-this._hY2;var bX=b0>3&&bU.minBounceBackAngle>0;if(!bX){this._hBlockedIndex=null}if(Math.abs(bY)>b0||Math.abs(bW)>b0){if(bX){var bT=Math.atan2(bY,bW);var e=Math.atan2(this._hX2-this._hX1,this._hY2-this._hY1);var bR=Math.atan2(Math.sin(bT-e),Math.cos(bT-e));if(Math.abs(bR)>bU.minBounceBackAngle){this._hBlockedIndex=null}}this._hX1=this._hX2;this._hY1=this._hY2;this._hX2=bZ;this._hY2=bV;return true}return false};H.prototype._resetStartPredicate=function(){var e=this._startPredicateData;if(e){if(e.delayTimer){e.delayTimer=window.clearTimeout(e.delayTimer)}this._startPredicateData=null}};H.prototype._checkOverlap=function(){if(!this._isActive){return}var bX=this._item;var bS=this._getGrid()._settings;var bY;var bW;var bU;var bT;var e;var bR;var bV;if(w(bS.dragSortPredicate)){bY=bS.dragSortPredicate(bX,this._dragEvent)}else{bY=H.defaultSortPredicate(bX,bS.dragSortPredicate)}if(!bY||typeof bY.index!=="number"){return}bW=bX.getGrid();bT=bY.grid||bW;bV=bW!==bT;bU=bW._items.indexOf(bX);e=aE(bT._items,bY.index,bV);bR=bY.action===W?W:ah;if(!bV&&e===this._hBlockedIndex){return}if(!bV){if(bU!==e){this._hBlockedIndex=bU;(bR===W?ao:aF)(bW._items,bU,e);if(bW._hasListeners(j)){bW._emit(j,{item:bX,fromIndex:bU,toIndex:e,action:bR})}bW.layout()}}else{this._hBlockedIndex=null;if(bW._hasListeners(bN)){bW._emit(bN,{item:bX,fromGrid:bW,fromIndex:bU,toGrid:bT,toIndex:e})}if(bT._hasListeners(aJ)){bT._emit(aJ,{item:bX,fromGrid:bW,fromIndex:bU,toGrid:bT,toIndex:e})}bX._gridId=bT._id;this._isMigrating=bX._gridId!==this._gridId;bW._items.splice(bU,1);A(bT._items,bX,e);bX._sortData=null;if(bW._hasListeners(t)){bW._emit(t,{item:bX,fromGrid:bW,fromIndex:bU,toGrid:bT,toIndex:e})}if(bT._hasListeners(bD)){bT._emit(bD,{item:bX,fromGrid:bW,fromIndex:bU,toGrid:bT,toIndex:e})}bW.layout();bT.layout()}};H.prototype._finishMigration=function(){var b1=this._item;var bX=b1._release;var bU=b1._element;var b0=b1._isActive;var bT=b1.getGrid();var bW=bT._element;var bR=bT._settings;var bV=bR.dragContainer||bW;var e=this._getGrid()._settings;var bZ=bU.parentNode;var bS;var bY;this._isMigrating=false;this.destroy();aU(bU,e.itemClass);aU(bU,e.itemVisibleClass);aU(bU,e.itemHiddenClass);F(bU,bR.itemClass);F(bU,b0?bR.itemVisibleClass:bR.itemHiddenClass);if(bV!==bZ){bV.appendChild(bU);bY=aR(bZ,bV,true);bS=bM(bU);bS.x-=bY.left;bS.y-=bY.top}b1._refreshDimensions();b1._refreshSortData();bY=aR(bV,bW,true);bX._containerDiffX=bY.left;bX._containerDiffY=bY.top;b1._drag=bR.dragEnabled?new H(b1):null;if(bV!==bZ){bU.style[M]=ap(bS.x,bS.y)}b1._child.removeAttribute("style");aW(b1._child,b0?bR.visibleStyles:bR.hiddenStyles);bX.start()};H.prototype._preStartCheck=function(e){if(this._startPredicateState===bH){this._startPredicateState=ab}if(this._startPredicateState===ab){this._startPredicateResult=this._startPredicate(this._item,e);if(this._startPredicateResult===true){this._startPredicateState=l;this._onStart(e)}else{if(this._startPredicateResult===false){this._startPredicateState=aS}}}else{if(this._startPredicateState===l&&this._isActive){this._onMove(e)}}};H.prototype._preEndCheck=function(e){var bR=this._startPredicateState===l;this._startPredicate(this._item,e);this._startPredicateState=bH;if(bR&&this._isActive){this._onEnd(e)}};H.prototype._onStart=function(bS){var b4=this._item;if(!b4._isActive){return}var bW=b4._element;var e=this._getGrid();var bV=e._settings;var b2=b4._release;var b5=b4._migrate;var bX=e._element;var bY=bV.dragContainer||bX;var b1=aT(bY,true);var bU=bM(bW);var bT=bU.x;var bZ=bU.y;var b0=bW.getBoundingClientRect();var bR=bY!==bX;var b3;this._resetHeuristics(bS);if(bR){b3=aR(b1,bX)}if(b4.isPositioning()){b4._layout.stop(true,{transform:ap(bT,bZ)})}if(b5._isActive){bT-=b5._containerDiffX;bZ-=b5._containerDiffY;b5.stop(true,{transform:ap(bT,bZ)})}if(b4.isReleasing()){b2._reset()}this._isActive=true;this._dragEvent=bS;this._container=bY;this._containingBlock=b1;this._elementClientX=b0.left;this._elementClientY=b0.top;this._left=this._gridX=bT;this._top=this._gridY=bZ;if(bV.dragPlaceholder.enabled){b4._dragPlaceholder.create()}e._emit(bL,b4,bS);if(bR){this._containerDiffX=b3.left;this._containerDiffY=b3.top;if(bW.parentNode===bY){this._gridX=bT-this._containerDiffX;this._gridY=bZ-this._containerDiffY}else{this._left=bT+this._containerDiffX;this._top=bZ+this._containerDiffY;bY.appendChild(bW);bW.style[M]=ap(this._left,this._top)}}F(bW,bV.itemDraggingClass);this._bindScrollListeners();e._emit(i,b4,bS)};H.prototype._onMove=function(bU){var bT=this._item;if(!bT._isActive){this.stop();return}var bS=this._getGrid()._settings;var bR=bS.dragAxis;if(bR!=="y"){var bV=bU.clientX-this._dragEvent.clientX;this._left+=bV;this._gridX+=bV;this._elementClientX+=bV}if(bR!=="x"){var e=bU.clientY-this._dragEvent.clientY;this._top+=e;this._gridY+=e;this._elementClientY+=e}this._dragEvent=bU;g(bT._id,this._prepareMove,this._applyMove)};H.prototype._prepareMove=function(){if(!this._item._isActive){return}if(this._getGrid()._settings.dragSort){if(this._checkHeuristics(this._dragEvent)){this._checkOverlapDebounce()}}};H.prototype._applyMove=function(){var e=this._item;if(!e._isActive){return}e._element.style[M]=ap(this._left,this._top);this._getGrid()._emit(X,e,this._dragEvent)};H.prototype._onScroll=function(bR){var e=this._item;if(!e._isActive){this.stop();return}this._scrollEvent=bR;a(e._id,this._prepareScroll,this._applyScroll)};H.prototype._prepareScroll=function(){var bZ=this._item;if(!bZ._isActive){return}var bT=bZ._element;var e=this._getGrid();var bS=e._settings;var bR=bS.dragAxis;var bU=e._element;var bY;var bX=bT.getBoundingClientRect();var bW=this._elementClientX-bX.left;var bV=this._elementClientY-bX.top;if(this._container!==bU){bY=aR(this._containingBlock,bU);this._containerDiffX=bY.left;this._containerDiffY=bY.top}if(bR!=="y"){this._left+=bW;this._gridX=this._left-this._containerDiffX}if(bR!=="x"){this._top+=bV;this._gridY=this._top-this._containerDiffY}if(bS.dragSort){this._checkOverlapDebounce()}};H.prototype._applyScroll=function(){var e=this._item;if(!e._isActive){return}e._element.style[M]=ap(this._left,this._top);this._getGrid()._emit(aq,e,this._scrollEvent)};H.prototype._onEnd=function(bV){var bU=this._item;var bS=bU._element;var bR=this._getGrid();var bT=bR._settings;var e=bU._release;if(!bU._isActive){this.stop();return}aN(bU._id);bP(bU._id);bT.dragSort&&this._checkOverlapDebounce("finish");this._unbindScrollListeners();e._containerDiffX=this._containerDiffX;e._containerDiffY=this._containerDiffY;this._reset();aU(bS,bT.itemDraggingClass);bR._emit(at,bU,bV);this._isMigrating?this._finishMigration():e.start()};function o(bS,bR){if(bS.left+bS.width<=bR.left||bR.left+bR.width<=bS.left||bS.top+bS.height<=bR.top||bR.top+bR.height<=bS.top){return 0}var bT=Math.min(bS.left+bS.width,bR.left+bR.width)-Math.max(bS.left,bR.left);var e=Math.min(bS.top+bS.height,bR.top+bR.height)-Math.max(bS.top,bR.top);var bV=Math.min(bS.width,bR.width);var bU=Math.min(bS.height,bR.height);return((bT*e)/(bV*bU))*100}function be(bR){if(bR.tagName.toLowerCase()!=="a"){return}var e=bR.getAttribute("href");if(!e){return}var bS=bR.getAttribute("target");if(bS&&bS!=="_self"){window.open(e,bS)}else{window.location.href=e}}function a8(e){this._item=e;this._animate=new aX();this._element=null;this._className="";this._didMigrate=false;this._resetAfterLayout=false;this._currentLeft=0;this._currentTop=0;this._nextLeft=0;this._nextTop=0;this._setupAnimation=this._setupAnimation.bind(this);this._startAnimation=this._startAnimation.bind(this);this._onLayoutStart=this._onLayoutStart.bind(this);this._onLayoutEnd=this._onLayoutEnd.bind(this);this._onReleaseEnd=this._onReleaseEnd.bind(this);this._onMigrate=this._onMigrate.bind(this)}a8.prototype._onLayoutStart=function(){var bW=this._item;var bT=bW.getGrid();var bU=bT._items.indexOf(bW);var bR=bT._layout.slots[bU*2];var bS=bT._layout.slots[bU*2+1];if(!this._didMigrate&&bW._left===bR&&bW._top===bS){return}bR+=bW._marginLeft;bS+=bW._marginTop;var e=bT._settings.dragPlaceholder.duration>0;if(!e||this._didMigrate){C(bW._id);var bV={transform:ap(bR,bS)};if(this._animate.isAnimating()){this._animate.stop(bV)}else{aW(this._element,bV)}if(this._didMigrate){bT.getElement().appendChild(this._element);this._didMigrate=false}return}this._nextLeft=bR;this._nextTop=bS;a3(bW._id,this._setupAnimation,this._startAnimation)};a8.prototype._setupAnimation=function(){if(!this.isActive()){return}var e=bM(this._element);this._currentLeft=e.x;this._currentTop=e.y};a8.prototype._startAnimation=function(){if(!this.isActive()){return}var bX=this._animate;var bW=this._currentLeft;var bR=this._currentTop;var e=this._nextLeft;var bS=this._nextTop;var bV={transform:ap(e,bS)};if(bW===e&&bR===bS){if(bX.isAnimating()){bX.stop(bV)}return}var bT=this._item.getGrid()._settings.dragPlaceholder;var bU={transform:ap(bW,bR)};bX.start(bU,bV,{duration:bT.duration,easing:bT.easing,onFinish:this._onLayoutEnd})};a8.prototype._onLayoutEnd=function(){if(this._resetAfterLayout){this.reset()}};a8.prototype._onReleaseEnd=function(e){if(e._id===this._item._id){if(!this._animate.isAnimating()){this.reset();return}this._resetAfterLayout=true}};a8.prototype._onMigrate=function(bR){if(bR.item!==this._item){return}var e=this._item.getGrid();var bS=bR.toGrid;e.off(ae,this._onReleaseEnd);e.off(U,this._onLayoutStart);e.off(bN,this._onMigrate);bS.on(ae,this._onReleaseEnd);bS.on(U,this._onLayoutStart);bS.on(bN,this._onMigrate);this._didMigrate=true};a8.prototype.create=function(){if(this.isActive()){this._resetAfterLayout=false;return}var bT=this._item;var bR=bT.getGrid();var bS=bR._settings;var bU=this._animate;var e;if(w(bS.dragPlaceholder.createElement)){e=bS.dragPlaceholder.createElement(bT)}else{e=window.document.createElement("div")}this._element=e;bU._element=e;this._className=bS.itemPlaceholderClass||"";if(this._className){F(e,this._className)}var bW=bT._left+bT._marginLeft;var bV=bT._top+bT._marginTop;aW(e,{display:"block",position:"absolute",left:"0",top:"0",width:bT._width+"px",height:bT._height+"px",transform:ap(bW,bV)});bR.on(U,this._onLayoutStart);bR.on(ae,this._onReleaseEnd);bR.on(bN,this._onMigrate);if(w(bS.dragPlaceholder.onCreate)){bS.dragPlaceholder.onCreate(bT,e)}bR.getElement().appendChild(e)};a8.prototype.reset=function(){if(!this.isActive()){return}var bR=this._element;var bT=this._item;var e=bT.getGrid();var bS=e._settings;var bU=this._animate;this._resetAfterLayout=false;C(bT._id);bU.stop();bU._element=null;e.off(ae,this._onReleaseEnd);e.off(U,this._onLayoutStart);e.off(bN,this._onMigrate);if(this._className){aU(bR,this._className);this._className=""}bR.parentNode.removeChild(bR);this._element=null;if(w(bS.dragPlaceholder.onRemove)){bS.dragPlaceholder.onRemove(bT,bR)}};a8.prototype.updateDimensions=function(bR,e){if(this.isActive()){aW(this._element,{width:bR+"px",height:e+"px"})}};a8.prototype.isActive=function(){return !!this._element};a8.prototype.destroy=function(){this.reset();this._animate.destroy();this._item=this._animate=null};function af(){this._queue=[];this._isDestroyed=false}af.prototype.add=function(e){if(this._isDestroyed){return this}this._queue.push(e);return this};af.prototype.flush=function(bT,bS){if(this._isDestroyed){return this}var e=this._queue;var bW=e.length;var bU;if(!bW){return this}var bV=bW===1;var bR=bV?e[0]:e.slice(0);e.length=0;if(bV){bR(bT,bS);return this}for(bU=0;bU<bW;bU++){bR[bU](bT,bS);if(this._isDestroyed){break}}return this};af.prototype.destroy=function(){if(this._isDestroyed){return this}this._isDestroyed=true;this._queue.length=0;return this};function B(e){this._item=e;this._isActive=false;this._isDestroyed=false;this._isInterrupted=false;this._currentStyles={};this._targetStyles={};this._currentLeft=0;this._currentTop=0;this._offsetLeft=0;this._offsetTop=0;this._skipNextAnimation=false;this._animateOptions={onFinish:this._finish.bind(this)};this._queue=new af();this._setupAnimation=this._setupAnimation.bind(this);this._startAnimation=this._startAnimation.bind(this)}B.prototype.start=function(bR,bW){if(this._isDestroyed){return}var b1=this._item;var bU=b1._element;var b0=b1._release;var bZ=b1.getGrid()._settings;var bY=this._isActive;var bV=b0._isActive&&b0._isPositioningStarted===false;var bS=bV?bZ.dragReleaseDuration:bZ.layoutDuration;var bT=bV?bZ.dragReleaseEasing:bZ.layoutEasing;var bX=!bR&&!this._skipNextAnimation&&bS>0;var e;if(bY){this._queue.flush(true,b1)}if(bV){b0._isPositioningStarted=true}if(w(bW)){this._queue.add(bW)}if(!bX){this._updateOffsets();this._updateTargetStyles();e=b1._animate.isAnimating();this.stop(false,this._targetStyles);!e&&aW(bU,this._targetStyles);this._skipNextAnimation=false;return this._finish()}this._isActive=true;this._animateOptions.easing=bT;this._animateOptions.duration=bS;this._isInterrupted=bY;bx(b1._id,this._setupAnimation,this._startAnimation);return this};B.prototype.stop=function(bS,bR){if(this._isDestroyed||!this._isActive){return this}var e=this._item;br(e._id);e._animate.stop(bR);aU(e._element,e.getGrid()._settings.itemPositioningClass);this._isActive=false;if(bS){this._queue.flush(true,e)}return this};B.prototype.destroy=function(){if(this._isDestroyed){return this}this.stop(true,{});this._queue.destroy();this._item=this._currentStyles=this._targetStyles=this._animateOptions=null;this._isDestroyed=true;return this};B.prototype._updateOffsets=function(){if(this._isDestroyed){return}var bS=this._item;var bR=bS._migrate;var e=bS._release;this._offsetLeft=e._isActive?e._containerDiffX:bR._isActive?bR._containerDiffX:0;this._offsetTop=e._isActive?e._containerDiffY:bR._isActive?bR._containerDiffY:0};B.prototype._updateTargetStyles=function(){if(this._isDestroyed){return}this._targetStyles.transform=ap(this._item._left+this._offsetLeft,this._item._top+this._offsetTop)};B.prototype._finish=function(){if(this._isDestroyed){return}var bS=this._item;var bR=bS._migrate;var e=bS._release;if(this._isActive){this._isActive=false;aU(bS._element,bS.getGrid()._settings.itemPositioningClass)}if(e._isActive){e.stop()}if(bR._isActive){bR.stop()}this._queue.flush(false,bS)};B.prototype._setupAnimation=function(){var e=bM(this._item._element);this._currentLeft=e.x;this._currentTop=e.y};B.prototype._startAnimation=function(){var bR=this._item;var e=bR.getGrid()._settings;this._updateOffsets();this._updateTargetStyles();if(bR._left===this._currentLeft-this._offsetLeft&&bR._top===this._currentTop-this._offsetTop){if(this._isInterrupted){this.stop(false,this._targetStyles)}this._isActive=false;this._finish();return}if(!this._isInterrupted){F(bR._element,e.itemPositioningClass)}this._currentStyles.transform=ap(this._currentLeft,this._currentTop);bR._animate.start(this._currentStyles,this._targetStyles,this._animateOptions)};var s={};function bg(e){this._item=e;this._isActive=false;this._isDestroyed=false;this._container=false;this._containerDiffX=0;this._containerDiffY=0}bg.prototype.start=function(b0,b9,bY){if(this._isDestroyed){return this}var b5=this._item;var bS=b5._element;var b3=b5.isVisible();var e=b5.getGrid();var b4=e._settings;var bU=b0._settings;var bW=b0._element;var bT=b0._items;var bR=e._items.indexOf(b5);var b6=bY||window.document.body;var b7;var bV;var bZ;var b2;var b1;var bX;var ca;var b8;if(typeof b9==="number"){b7=aE(bT,b9,true)}else{bV=b0._getItem(b9);if(!bV){return this}b7=bT.indexOf(bV)}if(b5.isPositioning()||this._isActive||b5.isReleasing()){bX=bM(bS);ca=bX.x;b8=bX.y}if(b5.isPositioning()){b5._layout.stop(true,{transform:ap(ca,b8)})}if(this._isActive){ca-=this._containerDiffX;b8-=this._containerDiffY;this.stop(true,{transform:ap(ca,b8)})}if(b5.isReleasing()){ca-=b5._release._containerDiffX;b8-=b5._release._containerDiffY;b5._release.stop(true,{transform:ap(ca,b8)})}b5._visibility._stopAnimation();if(b5._drag){b5._drag.destroy()}b5._visibility._queue.flush(true,b5);if(e._hasListeners(bN)){e._emit(bN,{item:b5,fromGrid:e,fromIndex:bR,toGrid:b0,toIndex:b7})}if(b0._hasListeners(aJ)){b0._emit(aJ,{item:b5,fromGrid:e,fromIndex:bR,toGrid:b0,toIndex:b7})}aU(bS,b4.itemClass);aU(bS,b4.itemVisibleClass);aU(bS,b4.itemHiddenClass);F(bS,bU.itemClass);F(bS,b3?bU.itemVisibleClass:bU.itemHiddenClass);e._items.splice(bR,1);A(bT,b5,b7);b5._gridId=b0._id;bZ=bS.parentNode;if(b6!==bZ){b6.appendChild(bS);b2=aR(b6,bZ,true);if(!bX){bX=bM(bS);ca=bX.x;b8=bX.y}bS.style[M]=ap(ca+b2.left,b8+b2.top)}b5._child.removeAttribute("style");aW(b5._child,b3?bU.visibleStyles:bU.hiddenStyles);bS.style.display=b3?"block":"hidden";b1=aR(b6,bW,true);b5._refreshDimensions();b5._refreshSortData();b5._drag=bU.dragEnabled?new H(b5):null;this._isActive=true;this._container=b6;this._containerDiffX=b1.left;this._containerDiffY=b1.top;if(e._hasListeners(t)){e._emit(t,{item:b5,fromGrid:e,fromIndex:bR,toGrid:b0,toIndex:b7})}if(b0._hasListeners(bD)){b0._emit(bD,{item:b5,fromGrid:e,fromIndex:bR,toGrid:b0,toIndex:b7})}return this};bg.prototype.stop=function(bW,bT){if(this._isDestroyed||!this._isActive){return this}var bS=this._item;var bR=bS._element;var e=bS.getGrid();var bV=e._element;var bU;if(this._container!==bV){if(!bT){if(bW){bU=bM(bR);s.transform=ap(bU.x-this._containerDiffX,bU.y-this._containerDiffY)}else{s.transform=ap(bS._left,bS._top)}bT=s}bV.appendChild(bR);aW(bR,bT)}this._isActive=false;this._container=null;this._containerDiffX=0;this._containerDiffY=0;return this};bg.prototype.destroy=function(){if(this._isDestroyed){return this}this.stop(true);this._item=null;this._isDestroyed=true;return this};var az={};function ar(e){this._item=e;this._isActive=false;this._isDestroyed=false;this._isPositioningStarted=false;this._containerDiffX=0;this._containerDiffY=0}ar.prototype.start=function(){if(this._isDestroyed||this._isActive){return this}var bR=this._item;var e=bR.getGrid();this._isActive=true;F(bR._element,e._settings.itemReleasingClass);e._emit(q,bR);bR._layout.start(false);return this};ar.prototype.stop=function(bW,bU){if(this._isDestroyed||!this._isActive){return this}var bT=this._item;var bS=bT._element;var bR=bT.getGrid();var e=bR._element;var bV;this._reset();if(bS.parentNode!==e){if(!bU){if(bW){bV=bM(bS);az.transform=ap(bV.x-this._containerDiffX,bV.y-this._containerDiffY)}else{az.transform=ap(bT._left,bT._top)}bU=az}e.appendChild(bS);aW(bS,bU)}if(!bW){bR._emit(ae,bT)}return this};ar.prototype.destroy=function(){if(this._isDestroyed){return this}this.stop(true);this._item=null;this._isDestroyed=true;return this};ar.prototype._reset=function(){if(this._isDestroyed){return}var e=this._item;this._isActive=false;this._isPositioningStarted=false;this._containerDiffX=0;this._containerDiffY=0;aU(e._element,e.getGrid()._settings.itemReleasingClass)};function a4(e,bR){var bS={};for(var bT in bR){bS[bT]=bf(e,J(bT))}return bS}function n(bT){var bS=bT._isActive;var e=bT._element;var bR=bT.getGrid()._settings;this._item=bT;this._isDestroyed=false;this._isHidden=!bS;this._isHiding=false;this._isShowing=false;this._queue=new af();this._finishShow=this._finishShow.bind(this);this._finishHide=this._finishHide.bind(this);e.style.display=bS?"block":"none";F(e,bS?bR.itemVisibleClass:bR.itemHiddenClass);aW(bT._child,bS?bR.visibleStyles:bR.hiddenStyles)}n.prototype.show=function(bR,bW){if(this._isDestroyed){return this}var bV=this._item;var bT=bV._element;var e=this._queue;var bX=w(bW)?bW:null;var bS=bV.getGrid();var bU=bS._settings;if(!this._isShowing&&!this._isHidden){bX&&bX(false,bV);return this}if(this._isShowing&&!bR){bX&&e.add(bX);return this}if(!this._isShowing){e.flush(true,bV);aU(bT,bU.itemHiddenClass);F(bT,bU.itemVisibleClass);if(!this._isHiding){bT.style.display="block"}}bX&&e.add(bX);bV._isActive=this._isShowing=true;this._isHiding=this._isHidden=false;this._startAnimation(true,bR,this._finishShow);return this};n.prototype.hide=function(bR,bW){if(this._isDestroyed){return this}var bV=this._item;var bT=bV._element;var e=this._queue;var bX=w(bW)?bW:null;var bS=bV.getGrid();var bU=bS._settings;if(!this._isHiding&&this._isHidden){bX&&bX(false,bV);return this}if(this._isHiding&&!bR){bX&&e.add(bX);return this}if(!this._isHiding){e.flush(true,bV);F(bT,bU.itemHiddenClass);aU(bT,bU.itemVisibleClass)}bX&&e.add(bX);this._isHidden=this._isHiding=true;bV._isActive=this._isShowing=false;this._startAnimation(false,bR,this._finishHide);return this};n.prototype.destroy=function(){if(this._isDestroyed){return this}var bU=this._item;var bS=bU._element;var bR=bU.getGrid();var e=this._queue;var bT=bR._settings;this._stopAnimation({});e.flush(true,bU).destroy();aU(bS,bT.itemVisibleClass);aU(bS,bT.itemHiddenClass);this._item=null;this._isHiding=this._isShowing=false;this._isDestroyed=this._isHidden=true;return this};n.prototype._startAnimation=function(e,bR,bY){if(this._isDestroyed){return}var bZ=this._item;var bS=bZ.getGrid()._settings;var bV=e?bS.visibleStyles:bS.hiddenStyles;var bT=parseInt(e?bS.showDuration:bS.hideDuration)||0;var bX=(e?bS.showEasing:bS.hideEasing)||"ease";var bW=bR||bT<=0;var bU;if(!bV){bY&&bY();return}bs(bZ._id);if(bW){if(bZ._animateChild.isAnimating()){bZ._animateChild.stop(bV)}else{aW(bZ._child,bV)}bY&&bY();return}bh(bZ._id,function(){bU=a4(bZ._child,bV)},function(){bZ._animateChild.start(bU,bV,{duration:bT,easing:bX,onFinish:bY})})};n.prototype._stopAnimation=function(bR){if(this._isDestroyed){return}var e=this._item;bs(e._id);e._animateChild.stop(bR)};n.prototype._finishShow=function(){if(this._isHidden){return}this._isShowing=false;this._queue.flush(false,this._item)};var ak={};n.prototype._finishHide=function(){if(!this._isHidden){return}var e=this._item;this._isHiding=false;ak.transform=ap(0,0);e._layout.stop(true,ak);e._element.style.display="none";this._queue.flush(false,e)};var O=0;function aj(){return ++O}function Y(bR,e,bT){var bS=bR._settings;this._id=aj();this._gridId=bR._id;this._isDestroyed=false;this._left=0;this._top=0;this._element=e;this._child=e.children[0];if(e.parentNode!==bR._element){bR._element.appendChild(e)}F(e,bS.itemClass);if(typeof bT!=="boolean"){bT=bf(e,"display")!=="none"}this._isActive=bT;e.style.left="0";e.style.top="0";e.style[M]=ap(0,0);this._animate=new aX(e);this._animateChild=new aX(this._child);this._visibility=new n(this);this._layout=new B(this);this._migrate=new bg(this);this._release=new ar(this);this._dragPlaceholder=new a8(this);this._drag=bS.dragEnabled?new H(this):null;this._refreshDimensions();this._refreshSortData()}Y.prototype.getGrid=function(){return al[this._gridId]};Y.prototype.getElement=function(){return this._element};Y.prototype.getWidth=function(){return this._width};Y.prototype.getHeight=function(){return this._height};Y.prototype.getMargin=function(){return{left:this._marginLeft,right:this._marginRight,top:this._marginTop,bottom:this._marginBottom}};Y.prototype.getPosition=function(){return{left:this._left,top:this._top}};Y.prototype.isActive=function(){return this._isActive};Y.prototype.isVisible=function(){return !!this._visibility&&!this._visibility._isHidden};Y.prototype.isShowing=function(){return !!(this._visibility&&this._visibility._isShowing)};Y.prototype.isHiding=function(){return !!(this._visibility&&this._visibility._isHiding)};Y.prototype.isPositioning=function(){return !!(this._layout&&this._layout._isActive)};Y.prototype.isDragging=function(){return !!(this._drag&&this._drag._isActive)};Y.prototype.isReleasing=function(){return !!(this._release&&this._release._isActive)};Y.prototype.isDestroyed=function(){return this._isDestroyed};Y.prototype._refreshDimensions=function(){if(this._isDestroyed||this._visibility._isHidden){return}var e=this._element;var bR=this._dragPlaceholder;var bS=e.getBoundingClientRect();this._width=bS.width;this._height=bS.height;this._marginLeft=Math.max(0,b(e,"margin-left"));this._marginRight=Math.max(0,b(e,"margin-right"));this._marginTop=Math.max(0,b(e,"margin-top"));this._marginBottom=Math.max(0,b(e,"margin-bottom"));if(bR){bR.updateDimensions(this._width,this._height)}};Y.prototype._refreshSortData=function(){if(this._isDestroyed){return}var bR=(this._sortData={});var e=this.getGrid()._settings.sortData;var bS;for(bS in e){bR[bS]=e[bS](this,this._element)}};Y.prototype._destroy=function(e){if(this._isDestroyed){return}var bT=this._element;var bS=this.getGrid();var bU=bS._settings;var bR=bS._items.indexOf(this);this._release.destroy();this._migrate.destroy();this._layout.destroy();this._visibility.destroy();this._animate.destroy();this._animateChild.destroy();this._dragPlaceholder.destroy();this._drag&&this._drag.destroy();bT.removeAttribute("style");this._child.removeAttribute("style");aU(bT,bU.itemClass);bR>-1&&bS._items.splice(bR,1);e&&bT.parentNode.removeChild(bT);this._isActive=false;this._isDestroyed=true};function bc(){this._slots=[];this._slotSizes=[];this._freeSlots=[];this._newSlots=[];this._rectItem={};this._rectStore=[];this._rectId=0;this._layout={slots:null,setWidth:false,setHeight:false,width:false,height:false};this._sortRectsLeftTop=this._sortRectsLeftTop.bind(this);this._sortRectsTopLeft=this._sortRectsTopLeft.bind(this)}bc.prototype.getLayout=function(bU,e,bX,bT,b2){var bS=this._layout;var bZ=!!(b2&&b2.fillGaps);var bW=!!(b2&&b2.horizontal);var b1=!!(b2&&b2.alignRight);var bV=!!(b2&&b2.alignBottom);var bY=!!(b2&&b2.rounding);var b0=this._slotSizes;var bR;bS.slots=bT?bT:this._slots;bS.width=bW?0:bY?Math.round(e):e;bS.height=!bW?0:bY?Math.round(bX):bX;bS.setWidth=bW;bS.setHeight=!bW;bS.slots.length=0;b0.length=0;if(!bU.length){return bS}for(bR=0;bR<bU.length;bR++){this._addSlot(bU[bR],bW,bZ,bY,b1||bV)}if(b1){for(bR=0;bR<bS.slots.length;bR=bR+2){bS.slots[bR]=bS.width-(bS.slots[bR]+b0[bR])}}if(bV){for(bR=1;bR<bS.slots.length;bR=bR+2){bS.slots[bR]=bS.height-(bS.slots[bR]+b0[bR])}}b0.length=0;this._freeSlots.length=0;this._newSlots.length=0;this._rectId=0;return bS};bc.prototype._addSlot=(function(){var e=0.001;var bR={};return function(b4,bX,b3,b5,bY){var bT=this._layout;var bW=this._freeSlots;var b1=this._newSlots;var bV;var bZ;var b2;var bU;var bS;var b0;b1.length=0;bR.left=null;bR.top=null;bR.width=b4._width+b4._marginLeft+b4._marginRight;bR.height=b4._height+b4._marginTop+b4._marginBottom;if(b5){bR.width=Math.round(bR.width);bR.height=Math.round(bR.height)}for(bS=0;bS<bW.length;bS++){bZ=bW[bS];if(!bZ){continue}bV=this._getRect(bZ);if(bR.width<=bV.width+e&&bR.height<=bV.height+e){bR.left=bV.left;bR.top=bV.top;break}}if(bR.left===null){bR.left=!bX?0:bT.width;bR.top=!bX?bT.height:0;if(!b3){bU=true}}if(!bX&&bR.top+bR.height>bT.height){if(bR.left>0){b1.push(this._addRect(0,bT.height,bR.left,Infinity))}if(bR.left+bR.width<bT.width){b1.push(this._addRect(bR.left+bR.width,bT.height,bT.width-bR.left-bR.width,Infinity))}bT.height=bR.top+bR.height}if(bX&&bR.left+bR.width>bT.width){if(bR.top>0){b1.push(this._addRect(bT.width,0,Infinity,bR.top))}if(bR.top+bR.height<bT.height){b1.push(this._addRect(bT.width,bR.top+bR.height,Infinity,bT.height-bR.top-bR.height))}bT.width=bR.left+bR.width}for(bS=b3?0:bU?bW.length:bS;bS<bW.length;bS++){bZ=bW[bS];if(!bZ){continue}bV=this._getRect(bZ);b2=this._splitRect(bV,bR);for(b0=0;b0<b2.length;b0++){bZ=b2[b0];bV=this._getRect(bZ);if(bV.width>0.49&&bV.height>0.49&&((!bX&&bV.top<bT.height)||(bX&&bV.left<bT.width))){b1.push(bZ)}}}if(b1.length){this._purgeRects(b1).sort(bX?this._sortRectsLeftTop:this._sortRectsTopLeft)}if(bX){bT.width=Math.max(bT.width,bR.left+bR.width)}else{bT.height=Math.max(bT.height,bR.top+bR.height)}bT.slots.push(bR.left,bR.top);if(bY){this._slotSizes.push(bR.width,bR.height)}this._freeSlots=b1;this._newSlots=bW}})();bc.prototype._addRect=function(bU,bT,bS,e){var bV=++this._rectId;var bR=this._rectStore;bR[bV]=bU||0;bR[++this._rectId]=bT||0;bR[++this._rectId]=bS||0;bR[++this._rectId]=e||0;return bV};bc.prototype._getRect=function(bT,bS){var bR=bS?bS:this._rectItem;var e=this._rectStore;bR.left=e[bT]||0;bR.top=e[++bT]||0;bR.width=e[++bT]||0;bR.height=e[++bT]||0;return bR};bc.prototype._splitRect=(function(){var e=[];return function(bR,bS){e.length=0;if(!this._doRectsOverlap(bR,bS)){e.push(this._addRect(bR.left,bR.top,bR.width,bR.height));return e}if(bR.left<bS.left){e.push(this._addRect(bR.left,bR.top,bS.left-bR.left,bR.height))}if(bR.left+bR.width>bS.left+bS.width){e.push(this._addRect(bS.left+bS.width,bR.top,bR.left+bR.width-(bS.left+bS.width),bR.height))}if(bR.top<bS.top){e.push(this._addRect(bR.left,bR.top,bR.width,bS.top-bR.top))}if(bR.top+bR.height>bS.top+bS.height){e.push(this._addRect(bR.left,bS.top+bS.height,bR.width,bR.top+bR.height-(bS.top+bS.height)))}return e}})();bc.prototype._doRectsOverlap=function(bR,e){return !(bR.left+bR.width<=e.left||e.left+e.width<=bR.left||bR.top+bR.height<=e.top||e.top+e.height<=bR.top)};bc.prototype._isRectWithinRect=function(bR,e){return(bR.left>=e.left&&bR.top>=e.top&&bR.left+bR.width<=e.left+e.width&&bR.top+bR.height<=e.top+e.height)};bc.prototype._purgeRects=(function(){var bR={};var e={};return function(bU){var bS=bU.length;var bT;while(bS--){bT=bU.length;if(!bU[bS]){continue}this._getRect(bU[bS],bR);while(bT--){if(!bU[bT]||bS===bT){continue}if(this._isRectWithinRect(bR,this._getRect(bU[bT],e))){bU[bS]=0;break}}}return bU}})();bc.prototype._sortRectsTopLeft=(function(){var bR={};var e={};return function(bT,bS){this._getRect(bT,bR);this._getRect(bS,e);return bR.top<e.top?-1:bR.top>e.top?1:bR.left<e.left?-1:bR.left>e.left?1:0}})();bc.prototype._sortRectsLeftTop=(function(){var bR={};var e={};return function(bT,bS){this._getRect(bT,bR);this._getRect(bS,e);return bR.left<e.left?-1:bR.left>e.left?1:bR.top<e.top?-1:bR.top>e.top?1:0}})();var T="[object HTMLCollection]";var a7="[object NodeList]";function aB(bR){var e=Object.prototype.toString.call(bR);return e===T||e===a7}var aQ="object";var aC="[object Object]";var v=Object.prototype.toString;function E(e){return typeof e===aQ&&v.call(e)===aC}function z(e){return aB(e)?Array.prototype.slice.call(e):Array.prototype.concat(e)}var c=new bc();var h=function(){};var aL="number";var aZ="string";var I="instant";function aI(bS,bR){var bU=this;var bT;var e;var bW;bS=this._element=typeof bS===aZ?window.document.querySelector(bS):bS;var bV=bS.getRootNode?bS.getRootNode({composed:true})===document:window.document.body.contains(bS);if(!bV||bS===window.document.documentElement){throw new Error("Container element must be an existing DOM element")}bT=this._settings=x(aI.defaultOptions,bR);if(!w(bT.dragSort)){bT.dragSort=!!bT.dragSort}this._id=aj();al[this._id]=bU;this._isDestroyed=false;this._layout={id:0,items:[],slots:[],setWidth:false,setHeight:false,width:0,height:0};this._emitter=new aw();F(bS,bT.containerClass);this._items=[];e=bT.items;if(typeof e===aZ){z(bS.children).forEach(function(bX){if(e==="*"||D(bX,e)){bU._items.push(new Y(bU,bX))}})}else{if(Array.isArray(e)||aB(e)){this._items=z(e).map(function(bX){return new Y(bU,bX)})}}bW=bT.layoutOnResize;if(typeof bW!==aL){bW=bW===true?0:-1}if(bW>=0){window.addEventListener("resize",(bU._resizeHandler=bp(function(){bU.refreshItems().layout()},bW)))}if(bT.layoutOnInit){this.layout(true)}}aI.Item=Y;aI.ItemLayout=B;aI.ItemVisibility=n;aI.ItemMigrate=bg;aI.ItemAnimate=aX;aI.ItemDrag=H;aI.ItemRelease=ar;aI.ItemDragPlaceholder=a8;aI.Emitter=aw;aI.Dragger=bG;aI.Packer=bc;aI.defaultOptions={items:"*",showDuration:300,showEasing:"ease",hideDuration:300,hideEasing:"ease",visibleStyles:{opacity:"1",transform:"scale(1)"},hiddenStyles:{opacity:"0",transform:"scale(0.5)"},layout:{fillGaps:false,horizontal:false,alignRight:false,alignBottom:false,rounding:true},layoutOnResize:100,layoutOnInit:true,layoutDuration:300,layoutEasing:"ease",sortData:null,dragEnabled:false,dragContainer:null,dragStartPredicate:{distance:0,delay:0,handle:false},dragAxis:null,dragSort:true,dragSortHeuristics:{sortInterval:100,minDragDistance:10,minBounceBackAngle:1},dragSortPredicate:{threshold:50,action:ah},dragReleaseDuration:300,dragReleaseEasing:"ease",dragCssProps:{touchAction:"none",userSelect:"none",userDrag:"none",tapHighlightColor:"rgba(0, 0, 0, 0)",touchCallout:"none",contentZooming:"none"},dragPlaceholder:{enabled:false,duration:300,easing:"ease",createElement:null,onCreate:null,onRemove:null},containerClass:"muuri",itemClass:"muuri-item",itemVisibleClass:"muuri-item-shown",itemHiddenClass:"muuri-item-hidden",itemPositioningClass:"muuri-item-positioning",itemDraggingClass:"muuri-item-dragging",itemReleasingClass:"muuri-item-releasing",itemPlaceholderClass:"muuri-item-placeholder"};aI.prototype.on=function(e,bR){this._emitter.on(e,bR);return this};aI.prototype.off=function(e,bR){this._emitter.off(e,bR);return this};aI.prototype.getElement=function(){return this._element};aI.prototype.getItems=function(bR){if(this._isDestroyed||(!bR&&bR!==0)){return this._items.slice(0)}var bS=[];var e=z(bR);var bU;var bT;for(bT=0;bT<e.length;bT++){bU=this._getItem(e[bT]);bU&&bS.push(bU)}return bS};aI.prototype.refreshItems=function(bR){if(this._isDestroyed){return this}var e=this.getItems(bR);var bS;for(bS=0;bS<e.length;bS++){e[bS]._refreshDimensions()}return this};aI.prototype.refreshSortData=function(bR){if(this._isDestroyed){return this}var e=this.getItems(bR);var bS;for(bS=0;bS<e.length;bS++){e[bS]._refreshSortData()}return this};aI.prototype.synchronize=function(){if(this._isDestroyed){return this}var e=this._element;var bR=this._items;var bS;var bU;var bT;if(bR.length){for(bT=0;bT<bR.length;bT++){bU=bR[bT]._element;if(bU.parentNode===e){bS=bS||window.document.createDocumentFragment();bS.appendChild(bU)}}if(bS){e.appendChild(bS)}}this._emit(bE);return this};aI.prototype.layout=function(bR,bX){if(this._isDestroyed){return this}var bV=this;var bU=this._element;var bW=this._updateLayout();var bY=bW.id;var b1=bW.items.length;var e=b1;var bZ;var b0;var bT;function bS(){if(--e>0){return}var b2=bV._layout.id!==bY;var b3=w(bR)?bR:bX;if(w(b3)){b3(b2,bW.items.slice(0))}if(!b2&&bV._hasListeners(y)){bV._emit(y,bW.items.slice(0))}}if((bW.setHeight&&typeof bW.height===aL)||(bW.setWidth&&typeof bW.width===aL)){bZ=bf(bU,"box-sizing")==="border-box"}if(bW.setHeight){if(typeof bW.height===aL){bU.style.height=(bZ?bW.height+this._borderTop+this._borderBottom:bW.height)+"px"}else{bU.style.height=bW.height}}if(bW.setWidth){if(typeof bW.width===aL){bU.style.width=(bZ?bW.width+this._borderLeft+this._borderRight:bW.width)+"px"}else{bU.style.width=bW.width}}if(this._hasListeners(U)){this._emit(U,bW.items.slice(0))}if(!b1){bS();return this}for(bT=0;bT<b1;bT++){b0=bW.items[bT];if(!b0){continue}b0._left=bW.slots[bT*2];b0._top=bW.slots[bT*2+1];b0.isDragging()?bS():b0._layout.start(bR===true,bS)}return this};aI.prototype.add=function(e,bY){if(this._isDestroyed||!e){return[]}var bX=z(e);if(!bX.length){return bX}var bR=bY||0;var bT=bR.layout?bR.layout:bR.layout===undefined;var bV=this._items;var bU=false;var bW;var bS;for(bS=0;bS<bX.length;bS++){bW=new Y(this,bX[bS],bR.isActive);bX[bS]=bW;if(bW._isActive){bU=true;bW._layout._skipNextAnimation=true}}A(bV,bX,bR.index);if(this._hasListeners(ai)){this._emit(ai,bX.slice(0))}if(bU&&bT){this.layout(bT===I,w(bT)?bT:undefined)}return bX};aI.prototype.remove=function(bW,bZ){if(this._isDestroyed){return this}var e=bZ||0;var bT=e.layout?e.layout:e.layout===undefined;var bU=false;var bV=this.getItems();var bR=this.getItems(bW);var bX=[];var bY;var bS;for(bS=0;bS<bR.length;bS++){bY=bR[bS];bX.push(bV.indexOf(bY));if(bY._isActive){bU=true}bY._destroy(e.removeElements)}if(this._hasListeners(bq)){this._emit(bq,bR.slice(0),bX)}if(bU&&bT){this.layout(bT===I,w(bT)?bT:undefined)}return bR};aI.prototype.show=function(e,bR){if(this._isDestroyed){return this}this._setItemsVisibility(e,true,bR);return this};aI.prototype.hide=function(e,bR){if(this._isDestroyed){return this}this._setItemsVisibility(e,false,bR);return this};aI.prototype.filter=function(b0,b3){if(this._isDestroyed||!this._items.length){return this}var b1=[];var bX=[];var bS=typeof b0===aZ;var bU=w(b0);var e=b3||0;var bW=e.instant===true;var bV=e.layout?e.layout:e.layout===undefined;var bY=w(e.onFinish)?e.onFinish:null;var bZ=-1;var bR=h;var b2;var bT;if(bY){bR=function(){++bZ&&bY(b1.slice(0),bX.slice(0))}}if(bU||bS){for(bT=0;bT<this._items.length;bT++){b2=this._items[bT];if(bU?b0(b2):D(b2._element,b0)){b1.push(b2)}else{bX.push(b2)}}}if(b1.length){this.show(b1,{instant:bW,onFinish:bR,layout:false})}else{bR()}if(bX.length){this.hide(bX,{instant:bW,onFinish:bR,layout:false})}else{bR()}if(b1.length||bX.length){if(this._hasListeners(S)){this._emit(S,b1.slice(0),bX.slice(0))}if(bV){this.layout(bV===I,w(bV)?bV:undefined)}}return this};aI.prototype.sort=(function(){var bY;var bX;var bS;var bU;function bR(bZ){return bZ.trim().split(" ").map(function(b0){return b0.split(":")})}function e(bZ){var b0={};for(var b1=0;b1<bZ.length;b1++){b0[bZ[b1]._id]=b1}return b0}function bT(b2,b1){var b0=bU[b2._id];var bZ=bU[b1._id];return bX?bZ-b0:b0-bZ}function bW(b2,b0){var bZ=0;var b6;var b5;var b3;var b1;for(var b4=0;b4<bY.length;b4++){b6=bY[b4][0];b5=bY[b4][1];b3=(b2._sortData?b2:b2._refreshSortData())._sortData[b6];b1=(b0._sortData?b0:b0._refreshSortData())._sortData[b6];if(b5==="desc"||(!b5&&bX)){bZ=b1<b3?-1:b1>b3?1:0}else{bZ=b3<b1?-1:b3>b1?1:0}if(bZ){return bZ}}if(!bZ){if(!bU){bU=e(bS)}bZ=bT(b2,b0)}return bZ}function bV(b1,b0){var bZ=bY(b1,b0);if(bX&&bZ){bZ=-bZ}if(bZ){return bZ}if(!bU){bU=e(bS)}return bT(b1,b0)}return function(b2,b0){if(this._isDestroyed||this._items.length<2){return this}var bZ=this._items;var b4=b0||0;var b3=b4.layout?b4.layout:b4.layout===undefined;var b1;bY=b2;bX=!!b4.descending;bS=bZ.slice(0);bU=null;if(w(bY)){bZ.sort(bV)}else{if(typeof bY===aZ){bY=bR(b2);bZ.sort(bW)}else{if(Array.isArray(bY)){if(bY.length!==bZ.length){throw new Error("["+bj+"] sort reference items do not match with grid items.")}for(b1=0;b1<bZ.length;b1++){if(bY.indexOf(bZ[b1])<0){throw new Error("["+bj+"] sort reference items do not match with grid items.")}bZ[b1]=bY[b1]}if(bX){bZ.reverse()}}else{return this}}}if(this._hasListeners(aV)){this._emit(aV,bZ.slice(0),bS)}if(b3){this.layout(b3===I,w(b3)?b3:undefined)}return this}})();aI.prototype.move=function(b0,bV,b1){if(this._isDestroyed||this._items.length<2){return this}var bX=this._items;var e=b1||0;var bW=e.layout?e.layout:e.layout===undefined;var bZ=e.action===W;var bT=bZ?W:ah;var bU=this._getItem(b0);var bR=this._getItem(bV);var bY;var bS;if(bU&&bR&&bU!==bR){bY=bX.indexOf(bU);bS=bX.indexOf(bR);if(bZ){ao(bX,bY,bS)}else{aF(bX,bY,bS)}if(this._hasListeners(j)){this._emit(j,{item:bU,fromIndex:bY,toIndex:bS,action:bT})}if(bW){this.layout(bW===I,w(bW)?bW:undefined)}}return this};aI.prototype.send=function(bV,bT,e,bS){if(this._isDestroyed||bT._isDestroyed||this===bT){return this}bV=this._getItem(bV);if(!bV){return this}var bU=bS||0;var bR=bU.appendTo||window.document.body;var bW=bU.layoutSender?bU.layoutSender:bU.layoutSender===undefined;var bX=bU.layoutReceiver?bU.layoutReceiver:bU.layoutReceiver===undefined;bV._migrate.start(bT,e,bR);if(bV._migrate._isActive&&bV._isActive){if(bW){this.layout(bW===I,w(bW)?bW:undefined)}if(bX){bT.layout(bX===I,w(bX)?bX:undefined)}}return this};aI.prototype.destroy=function(bT){if(this._isDestroyed){return this}var e=this._element;var bR=this._items.slice(0);var bS;if(this._resizeHandler){window.removeEventListener("resize",this._resizeHandler)}for(bS=0;bS<bR.length;bS++){bR[bS]._destroy(bT)}aU(e,this._settings.containerClass);e.style.height="";e.style.width="";this._emit(bn);this._emitter.destroy();al[this._id]=undefined;this._isDestroyed=true;return this};aI.prototype._getItem=function(bR){if(this._isDestroyed||(!bR&&bR!==0)){return null}if(typeof bR===aL){return this._items[bR>-1?bR:this._items.length+bR]||null}if(bR instanceof Y){return bR._gridId===this._id?bR:null}for(var e=0;e<this._items.length;e++){if(this._items[e]._element===bR){return this._items[e]}}return null};aI.prototype._updateLayout=function(){var bU=this._layout;var bT=this._settings.layout;var bS;var e;var bV;var bR;++bU.id;bU.items.length=0;for(bR=0;bR<this._items.length;bR++){if(this._items[bR]._isActive){bU.items.push(this._items[bR])}}this._refreshDimensions();bS=this._width-this._borderLeft-this._borderRight;e=this._height-this._borderTop-this._borderBottom;if(w(bT)){bV=bT(bU.items,bS,e)}else{bV=c.getLayout(bU.items,bS,e,bU.slots,bT)}bU.slots=bV.slots;bU.setWidth=Boolean(bV.setWidth);bU.setHeight=Boolean(bV.setHeight);bU.width=bV.width;bU.height=bV.height;return bU};aI.prototype._emit=function(){if(this._isDestroyed){return}this._emitter.emit.apply(this._emitter,arguments)};aI.prototype._hasListeners=function(bR){var e=this._emitter._events[bR];return !!(e&&e.length)};aI.prototype._updateBoundingRect=function(){var e=this._element;var bR=e.getBoundingClientRect();this._width=bR.width;this._height=bR.height;this._left=bR.left;this._top=bR.top};aI.prototype._updateBorders=function(bU,bS,bT,e){var bR=this._element;if(bU){this._borderLeft=b(bR,"border-left-width")}if(bS){this._borderRight=b(bR,"border-right-width")}if(bT){this._borderTop=b(bR,"border-top-width")}if(e){this._borderBottom=b(bR,"border-bottom-width")}};aI.prototype._refreshDimensions=function(){this._updateBoundingRect();this._updateBorders(1,1,1,1)};aI.prototype._setItemsVisibility=function(b1,bY,bT){var e=this;var bU=this.getItems(b1);var bZ=bT||0;var bR=bZ.instant===true;var bV=bZ.onFinish;var b7=bZ.layout?bZ.layout:bZ.layout===undefined;var bX=bU.length;var b2=bY?bi:u;var b0=bY?m:bw;var bS=bY?"show":"hide";var b4=false;var bW=[];var b5=[];var b6;var b3;if(!bX){if(w(bV)){bV(bU)}return}if(this._hasListeners(b2)){this._emit(b2,bU.slice(0))}for(b3=0;b3<bU.length;b3++){b6=bU[b3];if((bY&&!b6._isActive)||(!bY&&b6._isActive)){b4=true}if(bY&&!b6._isActive){b6._layout._skipNextAnimation=true}if(bY&&b6._visibility._isHidden){b5.push(b6)}b6._visibility[bS](bR,function(b9,b8){if(!b9){bW.push(b8)}if(--bX<1){if(w(bV)){bV(bW.slice(0))}if(e._hasListeners(b0)){e._emit(b0,bW.slice(0))}}})}if(b5.length){this.refreshItems(b5)}if(b4&&b7){this.layout(b7===I,w(b7)?b7:undefined)}};function x(bR,bS){var e=ba({},bR);if(bS){e=ba(e,bS)}e.visibleStyles=(bS||0).visibleStyles||(bR||0).visibleStyles;e.hiddenStyles=(bS||0).hiddenStyles||(bR||0).hiddenStyles;return e}function ba(bV,bU){var bR=Object.keys(bU);var bS=bR.length;var bW;var bT;var e;for(e=0;e<bS;e++){bT=bR[e];bW=E(bU[bT]);if(E(bV[bT])&&bW){bV[bT]=ba(ba({},bV[bT]),bU[bT]);continue}if(bW){bV[bT]=ba({},bU[bT]);continue}if(Array.isArray(bU[bT])){bV[bT]=bU[bT].slice(0);continue}bV[bT]=bU[bT]}return bV}return aI}));