jQuery(document).ready(function($){var drag_enabled_or_disabled;if(!isMobileDevice()){drag_enabled_or_disabled=true}else{drag_enabled_or_disabled=false}initGrid();function initGrid(){var grid=new Muuri(".wpsi-grid",{dragEnabled:drag_enabled_or_disabled,dragSortHeuristics:{sortInterval:50,minDragDistance:10,minBounceBackAngle:1},dragPlaceholder:{enabled:false,duration:400,createElement:function(item){return item.getElement().cloneNode(true)}},dragReleaseDuration:400,dragReleseEasing:"ease",layoutOnInit:true}).on("move",function(){saveLayout(grid)});var layout=window.localStorage.getItem("layout");if(layout){loadLayout(grid,layout)}else{grid.layout(true)}saveLayout(grid)}function serializeLayout(grid){var itemIds=grid.getItems().map(function(item){return item.getElement().getAttribute("data-id")});return JSON.stringify(itemIds)}function saveLayout(grid){var layout=serializeLayout(grid);window.localStorage.setItem("layout",layout)}function loadLayout(grid,serializedLayout){var layout=JSON.parse(serializedLayout);var currentItems=grid.getItems();$(".wpsi-item").each(function(){var toggle_id=$(this).data("id");if(localStorage.getItem("toggle_data_id_"+toggle_id)===null){window.localStorage.setItem("toggle_data_id_"+toggle_id,"checked")}if(window.localStorage.getItem("toggle_data_id_"+toggle_id)=="checked"){$(this).addClass("muuri-active")}else{$(this).removeClass("muuri-active")}});var currentItemIds=currentItems.map(function(item){return item.getElement().getAttribute("data-id")});var newItems=[];var itemId;var itemIndex;for(var i=0;i<layout.length;i++){itemId=layout[i];itemIndex=currentItemIds.indexOf(itemId);if(itemIndex>-1){newItems.push(currentItems[itemIndex])}}grid.sort(newItems,{layout:"instant"});grid.filter(".muuri-active")}$(".wpsi-item").each(function(){var toggle_id=$(this).data("id");if(!window.localStorage.getItem("toggle_data_id_"+toggle_id)){window.localStorage.setItem("toggle_data_id_"+toggle_id,"checked")}$("#toggle_data_id_"+toggle_id).change(function(){if(document.getElementById("toggle_data_id_"+toggle_id).checked){window.localStorage.setItem("toggle_data_id_"+toggle_id,"checked")}else{window.localStorage.setItem("toggle_data_id_"+toggle_id,"unchecked")}initGrid()})});function isMobileDevice(){return typeof window.orientation!=="undefined"||navigator.userAgent.indexOf("IEMobile")!==-1}});